webpackJsonp([19],{nGNz:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("Dd8w"),a=r.n(i),o=r("TVG1"),s={name:"service-type",computed:{uploadUrl:function(){return localStorage.getItem("baseURL")+"/repair/service/category/import"}},data:function(){var e=this;return{uploadingModal:!1,uploadPercent:0,modalTitle:"新建服务分类",serviceModal:!1,filter:!1,tableColumn:[{title:"服务名称",key:"name",align:"center"},{title:"报修分类",key:"repairCategoryName",align:"center"},{title:"质保天数",key:"warrantyPeriod",align:"center"},{title:"客户收费标准",key:"serviceFee",align:"center"},{title:"员工结算标准",key:"employeeServiceCommission",align:"center"},{title:"操作",align:"center",render:function(t,r){var i=e;return t("div",[t("Button",{props:{type:"text",size:"small"},on:{click:function(){var e=r.row.id;i.getTypeInfo(e),i.serviceModal=!0,i.modalTitle="编辑服务分类"}}},"编辑"),t("Button",{props:{type:"text",size:"small"},on:{click:function(){var e=r.row.id;i.$store.commit("setDeleteModal",{model:!0,callback:function(){i.deleteType(e)}})}}},"删除")])}}],lists:[],repairLists:[],typeForm:{id:"",repairCategoryId:"",name:"",warrantyPeriod:0,serviceFee:0,employeeServiceCommission:0},typeFormRule:{name:[{required:!0,message:"请输入服务名称",trigger:"blur"}],repairCategoryId:[{required:!0,message:"请选择报修分类",trigger:"blur"}],warrantyPeriod:[{required:!0,message:"请设置质保天数",trigger:"blur",type:"number"}],serviceFee:[{required:!0,message:"请设置服务收费标准",trigger:"blur",type:"number"}],employeeServiceCommission:[{required:!0,message:"请设置员工结算标准",trigger:"blur",type:"number"}]},serviceFilter:{name:"",warrantyPeriodFlag:"Y",repairCategoryId:""}}},methods:{activeModalNew:function(){this.modalTitle="新建服务分类",this.typeForm={id:"",repairCategoryId:"",name:"",warrantyPeriod:0,serviceFee:0,employeeServiceCommission:0},this.serviceModal=!0},filterData:function(){var e=this.serviceFilter,t={name:e.name,warrantyPeriodFlag:e.warrantyPeriodFlag,repairCategoryId:e.repairCategoryId};this.getServiceList(t),this.filter=!1},clearFilter:function(){this.serviceFilter={name:"",warrantyPeriodFlag:"Y",repairCategoryId:""},this.filter=!1,this.getServiceList()},getServiceList:function(e){var t=this,r="";e&&(r=o.a.formatterParams(e)),this.$http.get("/repair/service/category/list?"+r).then(function(e){0===e.data.code?t.lists=e.data.data:t.$Message.error(e.data.msg)})},getTypeInfo:function(e){var t=this;this.$http.get("/repair/service/category/info?id="+e).then(function(e){if(0===e.data.code){var r=e.data.data;t.typeForm=r,t.typeForm.warrantyPeriod*=1,t.typeForm.serviceFee*=1,t.typeForm.employeeServiceCommission*=1}else t.$Message.error(e.data.msg)})},gerRepairList:function(){var e=this;this.$http.get("/repair/category/list").then(function(t){0===t.data.code?e.repairLists=t.data.data:e.$Message.error(t.data.msg)})},saveType:function(){var e=this,t=this.typeForm,r="";r=t.id.length>0?"/repair/service/category/edit":"/repair/service/category/add",this.$http.post(r,a()({},t)).then(function(t){0===t.data.code?(e.$Message.success("保存成功"),e.getServiceList()):e.$Message.error(t.data.msg),e.serviceModal=!1})},deleteType:function(e){var t=this;this.$http.delete("/repair/service/category/delete?id="+e).then(function(e){0===e.data.code?(t.$Message.info("删除成功"),t.$store.commit("setDeleteModal",{model:!1}),t.getServiceList()):(t.$Message.info(e.data.msg),_this.$store.commit("setDeleteModal",{model:!1}))})},modalHide:function(e){e||this.$refs.typeForm.resetFields()},downExcel:function(){var e=localStorage.getItem("baseURL")+"/repair/service/category/import/template";window.location.href=e},uploadSuccess:function(e,t,r){var i=this;setTimeout(function(){0===e.code?i.$Message.success("上传成功"):i.$Message.error(e.msg),i.uploadPercent=100,i.uploadingModal=!1,i.getServiceList()},1500)},uploading:function(){this.uploadingModal=!0;var e=this,t=setInterval(function(){e.uploadPercent>=90?clearTimeout(t):e.uploadPercent=e.uploadPercent+5},100)}},mounted:function(){this.getServiceList(),this.gerRepairList()}},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Card",[r("div",[r("div",{staticClass:"clearfix mb-15"},[r("div",{staticClass:"pull-left"},[r("Button",{attrs:{icon:"md-add"},on:{click:e.activeModalNew}},[e._v("新建")]),e._v(" "),r("Button",{attrs:{icon:"ios-funnel"},on:{click:function(t){e.filter=!0}}},[e._v("筛选")])],1),e._v(" "),r("div",{staticClass:"pull-right"},[r("Button",{attrs:{icon:"ios-cloud-download-outline"},on:{click:e.downExcel}},[e._v("excel导入模板下载")]),e._v(" "),r("div",{staticClass:"inline-block"},[r("Upload",{attrs:{action:e.uploadUrl,"with-credentials":!0,"show-upload-list":!1,"on-success":e.uploadSuccess,"before-upload":e.uploading}},[r("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[e._v("excel导入")])],1)],1)],1)]),e._v(" "),r("div",{staticClass:"table-wrapper"},[r("Table",{attrs:{data:e.lists,columns:e.tableColumn}})],1)])]),e._v(" "),r("Modal",{attrs:{title:e.modalTitle},on:{"on-visible-change":e.modalHide},model:{value:e.serviceModal,callback:function(t){e.serviceModal=t},expression:"serviceModal"}},[r("div",{staticClass:"modal_wrap_form"},[r("Form",{ref:"typeForm",attrs:{model:e.typeForm,rules:e.typeFormRule,"label-position":"top"}},[r("FormItem",{attrs:{label:"报修分类",prop:"repairCategoryId"}},[r("Select",{model:{value:e.typeForm.repairCategoryId,callback:function(t){e.$set(e.typeForm,"repairCategoryId",t)},expression:"typeForm.repairCategoryId"}},e._l(e.repairLists,function(t){return r("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}))],1),e._v(" "),r("FormItem",{attrs:{label:"服务名称",prop:"name"}},[r("Input",{model:{value:e.typeForm.name,callback:function(t){e.$set(e.typeForm,"name",t)},expression:"typeForm.name"}})],1),e._v(" "),r("FormItem",{attrs:{label:"质保天数",prop:"warrantyPeriod"}},[r("InputNumber",{staticStyle:{width:"100%"},attrs:{min:1,precision:0},model:{value:e.typeForm.warrantyPeriod,callback:function(t){e.$set(e.typeForm,"warrantyPeriod",t)},expression:"typeForm.warrantyPeriod"}})],1),e._v(" "),r("FormItem",{attrs:{label:"服务收费",prop:"serviceFee"}},[r("InputNumber",{staticStyle:{width:"100%"},attrs:{precision:2},model:{value:e.typeForm.serviceFee,callback:function(t){e.$set(e.typeForm,"serviceFee",t)},expression:"typeForm.serviceFee"}})],1),e._v(" "),r("FormItem",{attrs:{label:"员工结算标准",prop:"employeeServiceCommission"}},[r("InputNumber",{staticStyle:{width:"100%"},attrs:{precision:2},model:{value:e.typeForm.employeeServiceCommission,callback:function(t){e.$set(e.typeForm,"employeeServiceCommission",t)},expression:"typeForm.employeeServiceCommission"}})],1)],1)],1),e._v(" "),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{on:{click:function(t){e.serviceModal=!1}}},[e._v("取消")]),e._v(" "),r("Button",{attrs:{type:"primary"},on:{click:e.saveType}},[e._v(e._s(1===e.modalTitle?"添加":"保存"))])],1)]),e._v(" "),r("Drawer",{attrs:{title:"服务筛选",width:"425"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[r("div",{staticClass:"filter-top mb-15 clearfix"},[r("div",{staticClass:"pull-left"},[r("Button",{attrs:{icon:"md-close-circle"},on:{click:e.clearFilter}},[e._v("清空筛选条件")])],1),e._v(" "),r("div",{staticClass:"pull-right"},[r("Button",{attrs:{type:"primary"},on:{click:e.filterData}},[e._v("确定筛选")])],1)]),e._v(" "),r("Form",{model:{value:e.serviceFilter,callback:function(t){e.serviceFilter=t},expression:"serviceFilter"}},[r("FormItem",{attrs:{label:"报修分类"}},[r("Select",{model:{value:e.serviceFilter.repairCategoryId,callback:function(t){e.$set(e.serviceFilter,"repairCategoryId",t)},expression:"serviceFilter.repairCategoryId"}},e._l(e.repairLists,function(t){return r("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}))],1),e._v(" "),r("FormItem",{attrs:{label:"服务名称"}},[r("Input",{model:{value:e.serviceFilter.name,callback:function(t){e.$set(e.serviceFilter,"name",t)},expression:"serviceFilter.name"}})],1),e._v(" "),r("FormItem",{attrs:{label:"质保天数大于0"}},[r("i-switch",{attrs:{"true-value":"Y","false-value":""},model:{value:e.serviceFilter.warrantyPeriodFlag,callback:function(t){e.$set(e.serviceFilter,"warrantyPeriodFlag",t)},expression:"serviceFilter.warrantyPeriodFlag"}})],1)],1)],1),e._v(" "),r("Modal",{attrs:{title:"正在上传中...","mask-closable":!1,"footer-hide":!0,closable:!1},model:{value:e.uploadingModal,callback:function(t){e.uploadingModal=t},expression:"uploadingModal"}},[r("Progress",{attrs:{percent:e.uploadPercent,status:"active"}})],1)],1)},staticRenderFns:[]};var n=r("VU/8")(s,l,!1,function(e){r("uqbd")},"data-v-b5e2ceb6",null);t.default=n.exports},uqbd:function(e,t){}});
//# sourceMappingURL=19.652aee8ec0f82c4cf9ae.js.map