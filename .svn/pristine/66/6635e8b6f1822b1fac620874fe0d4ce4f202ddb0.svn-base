webpackJsonp([4],{Bf3l:function(t,e){},"G+W6":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Dd8w"),r=a.n(i),n=a("woOf"),o=a.n(n),s=a("TVG1"),l={name:"inport-admin",data:function(){return{pageName:"import",filter:!1,filterForm:{departmentId:"",inputType:"",outputType:"",sn:"",dateRange:[]},pageNo:1,pageSize:10,totalCount:0,lists:[],organLists:[]}},methods:{newIn:function(){"import"===this.pageName?this.$router.push({name:"importNew"}):this.$router.push({name:"newOut"})},getLists:function(t){var e=this,a="pageNo="+this.pageNo+"&pageSize="+this.pageSize,i="";t&&(a=a+"&"+s.a.formatterParams(t)),i="import"===this.pageName?"/repair/material/input/order/list":"/repair/material/output/order/list",this.$http.post(i+"?"+a).then(function(t){if(0===t.data.code){var a=t.data.data;e.lists=a.list,e.filter=!1}else console.log("辅材入库获取失败："+t.data.msg),e.filter=!1})},dateRangeChange:function(t){this.filterForm.startTime=t[0],this.filterForm.endTime=t[1]},pageChange:function(t){this.pageNo=t,this.getLists()},pageSizeChange:function(t){this.pageSize=t,this.getLists()},clearFilter:function(){this.$refs.filterForm.resetFields(),this.filterForm={departmentId:"",inputType:"",outputType:"",sn:"",dateRange:[]},this.getLists()},saveFilter:function(){var t=this.filterForm,e={};"import"===this.pageName?e={inputType:t.inputType,sn:t.sn}:"output"===this.pageName&&(e={outputType:t.outputType,sn:t.sn}),t.departmentId&&(e.departmentId=t.departmentId),t.dateRange[0]&&t.dateRange[1]&&(e=o()(e,{startTime:s.a.formateTime(t.dateRange[0],!0),endTime:s.a.formateTime(t.dateRange[1],!0)})),this.getLists(e)},goDetail:function(t){var e=this.pageName,a="";a="import"===e?"inDetail":"outDetail",this.$router.push({name:a,params:{id:t,type:e}})},exportExcel:function(){var t=this,e="";"import"===this.pageName?e="/repair/material/input/order/list/export":"output"===this.pageName&&(e="/repair/material/output/order/list/export");var a=r()({},this.filterForm);a.dateRange[0].length<=0?a.dateRange="":delete a.dateRange;var i="pageNo="+this.pageNo+"&pageSize="+this.pageSize,n=s.a.formatterParams(a);this.$http.post(e+"?"+i+"&"+n,null,{responseType:"blob"}).then(function(e){var a=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8"}),i=document.createElement("a"),r=window.URL.createObjectURL(a);i.href=r,"import"===t.pageName?i.download="辅材入库列表.xlsx":"output"===t.pageName&&(i.download="辅材出库列表.xlsx"),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(r)})}},mounted:function(){var t=this;this.pageName=this.$route.name,this.getLists(),s.a.getDepartment(function(e){t.organLists=e})},watch:{$route:function(t){var e=this;this.pageName=t.name,s.a.getDepartment(function(t){e.organLists=t}),this.getLists(),this.filterForm={departmentId:"",inputType:"",outputType:"",sn:"",dateRange:[]}}}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Card",[a("div",{staticClass:"clearfix mb-15"},[a("div",{staticClass:"pull-left"},["import"===t.pageName?a("Button",{attrs:{type:"primary"},on:{click:t.newIn}},[t._v("新建入库")]):t._e(),t._v(" "),"output"===t.pageName?a("Button",{attrs:{type:"primary"},on:{click:t.newIn}},[t._v("新建出库")]):t._e(),t._v(" "),a("Button",{on:{click:function(e){t.filter=!0}}},[t._v("筛选")])],1),t._v(" "),a("div",{staticClass:"pull-right"},[a("Button",{attrs:{type:"primary"},on:{click:t.exportExcel}},[t._v("excel导出")])],1)]),t._v(" "),a("div",{staticClass:"table-wrapper"},[a("table",{staticClass:"native-table"},[a("thead",[a("tr",[a("th",[t._v("组织名称")]),t._v(" "),a("th",[t._v("单号")]),t._v(" "),a("th",[t._v("创建时间")]),t._v(" "),a("th",[t._v(t._s("import"===t.pageName?"入库类别":"出库类别"))]),t._v(" "),a("th",[t._v("操作人")]),t._v(" "),a("th",[t._v(t._s("import"===t.pageName?"入库成本":"出库成本"))]),t._v(" "),a("th",[t._v("操作")])])]),t._v(" "),a("tbody",t._l(t.lists,function(e,i){return a("tr",{key:i},[a("td",[t._v(t._s(e.departmentName))]),t._v(" "),a("td",[t._v(t._s(e.orderSn))]),t._v(" "),a("td",[t._v(t._s(e.createTime))]),t._v(" "),a("td",[t._v(t._s("import"===t.pageName?e.inputType:e.outputType))]),t._v(" "),a("td",[t._v(t._s(e.creator))]),t._v(" "),a("td",[t._v(t._s(e.amount))]),t._v(" "),a("td",[a("Button",{attrs:{type:"text"},on:{click:function(a){t.goDetail(e.id)}}},[t._v("查看")])],1)])}))]),t._v(" "),a("div",{staticClass:"pagination"},[a("Page",{attrs:{total:t.totalCount,"show-elevator":"","show-sizer":""},on:{"on-change":t.pageChange,"on-page-size-change":t.pageSizeChange}})],1)]),t._v(" "),a("Drawer",{attrs:{title:"入库筛选",width:"450"},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}},[a("div",{staticClass:"clearfix mb-15"},[a("div",{staticClass:"pull-left"},[a("Button",{on:{click:t.clearFilter}},[t._v("清空筛选条件")])],1),t._v(" "),a("div",{staticClass:"pull-right"},[a("Button",{attrs:{type:"primary"},on:{click:t.saveFilter}},[t._v("确定筛选")])],1)]),t._v(" "),a("div",[a("Form",{ref:"filterForm",attrs:{"label-position":"top",model:t.filterForm}},[a("FormItem",{attrs:{label:"创建时间"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"daterange"},on:{"on-change":t.dateRangeChange},model:{value:t.filterForm.dateRange,callback:function(e){t.$set(t.filterForm,"dateRange",e)},expression:"filterForm.dateRange"}})],1),t._v(" "),a("FormItem",{attrs:{label:"组织名称"}},[a("Select",{model:{value:t.filterForm.departmentId,callback:function(e){t.$set(t.filterForm,"departmentId",e)},expression:"filterForm.departmentId"}},t._l(t.organLists,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}))],1),t._v(" "),"import"===t.pageName?a("FormItem",{attrs:{label:"入库类型"}},[a("Select",{model:{value:t.filterForm.inputType,callback:function(e){t.$set(t.filterForm,"inputType",e)},expression:"filterForm.inputType"}},[a("Option",{attrs:{value:"PURCHASE"}},[t._v("采购")])],1)],1):t._e(),t._v(" "),"output"===t.pageName?a("FormItem",{attrs:{label:"出库类型"}},[a("Select",{model:{value:t.filterForm.outputType,callback:function(e){t.$set(t.filterForm,"outputType",e)},expression:"filterForm.outputType"}},[a("Option",{attrs:{value:"REFUND"}},[t._v("退货")])],1)],1):t._e(),t._v(" "),a("FormItem",{attrs:{label:"原始单号"}},[a("Input",{model:{value:t.filterForm.sn,callback:function(e){t.$set(t.filterForm,"sn",e)},expression:"filterForm.sn"}})],1)],1)],1)])],1)},staticRenderFns:[]};var m=a("VU/8")(l,p,!1,function(t){a("Bf3l")},"data-v-42bf4918",null);e.default=m.exports}});
//# sourceMappingURL=4.a4c0522a6232c16f8e59.js.map