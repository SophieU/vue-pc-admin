webpackJsonp([35],{"9Gor":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r("Dd8w"),i=r.n(a),o=r("TVG1"),l={name:"staff-order-info",data:function(){var t=this;return{filter:!1,id:"",columns:[{title:"工单号",key:"sn",align:"center"},{title:"报修类型",key:"repairCategoryName",align:"center"},{title:"创建时间",key:"createTime",align:"center"},{title:"工单状态",key:"orderState",align:"center"},{title:"操作",align:"center",render:function(e,r){var a=t,i=r.row.id;return e("Button",{props:{type:"primary",size:"small"},on:{click:function(){a.$router.push({name:"orderDetail",query:{id:i}})}}},"查看订单")}}],lists:[],repairTypeLists:[],pageNo:1,pageSize:10,totalCount:0,orderCount:{},filterForm:{dateRange:[],orderStateList:[],repairCategoryId:"",startDate:"",endDate:""},filterDateRange:[]}},methods:{dateRangeChange:function(t){this.filterForm.startDate=t[0],this.filterForm.endDate=t[1]},getLists:function(t){var e=this,r={},a="pageNo="+this.pageNo+"&pageSize="+this.pageSize,o=this.id;t&&(r=t),this.$http.post("server/order/list?"+a,i()({id:o},r)).then(function(r){if(0===r.data.code){var a=r.data.data;e.pageSize=a.pageSize,e.totalCount=a.totalCount,e.lists=a.list,e.filter=!1,t&&t.startDate?e.filterDateRange=[t.startDate,t.endDate]:e.filterDateRange=[]}else console.log("员工工单列表："+r.data.msg)})},getOrderCount:function(){var t=this;this.$http.get("/server/order/count?id="+this.id).then(function(e){0===e.data.code&&(t.orderCount=e.data.data)})},clearFilter:function(t){this.filterForm={dateRange:[],orderStateList:[],repairCategoryId:"",startDate:"",endDate:""},this.$refs.filterForm.resetFields(),this.getLists(),this.filter=!1},sureFilter:function(){var t=i()({},this.filterForm);delete t.dateRange;var e={};for(var r in console.log(t),t)(t[r]&&t[r].length>0||t[r]>0)&&(e[r]=t[r]);this.getLists(e)},pageChange:function(t){this.pageNo=t;var e=i()({},this.filterForm);delete e.dateRange;var r={};for(var a in e)(e[a].length>0||e[a]>0)&&(r[a]=e[a]);this.getLists(r)},pageSizeChange:function(t){this.pageSize=t;var e=i()({},this.filterForm);delete e.dateRange;var r={};for(var a in e)(e[a].length>0||e[a]>0)&&(r[a]=e[a]);this.getLists(r)},exportExcel:function(){var t=i()({},this.filterForm);delete t.dateRange;var e={};for(var r in t)t[r],(t[r].length>0||t[r]>0)&&(e[r]=t[r]);var a=this.id;this.$http.post("/server/order/list/export",i()({id:a},e),{responseType:"blob"}).then(function(t){o.a.downloadExcel(t)})}},mounted:function(){var t=this;this.id=this.$route.query.id,this.getLists(),this.getOrderCount(),o.a.getRepairType(function(e){t.repairTypeLists=e})}},s={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{staticClass:"mb-15"},[r("table",{staticClass:"native-table"},[r("thead",[r("tr",[r("th",[t._v("历史订单总数")]),t._v(" "),r("th",[t._v("本月完工订单总数")])])]),t._v(" "),r("tbody",[r("tr",[r("td",[t._v(t._s(t.orderCount.totalOrderNum))]),t._v(" "),r("td",[t._v(t._s(t.orderCount.currentMonthOrderNum))])])])])]),t._v(" "),r("Card",[r("p",{staticStyle:{"font-weight":"normal",color:"#555"},attrs:{slot:"title"},slot:"title"},[t.filterDateRange[0]&&t.filterDateRange[1]?r("span",[t._v(" 时间：2018/08/01-2018/08/31")]):t._e()]),t._v(" "),r("div",{staticStyle:{"margin-top":"-5px"},attrs:{slot:"extra"},slot:"extra"},[r("Button",{on:{click:function(e){t.filter=!0}}},[t._v("筛选")]),t._v(" "),r("Button",{attrs:{type:"primary"},on:{click:t.exportExcel}},[t._v("excel导出")])],1),t._v(" "),r("div",{staticClass:"table-wrapper"},[r("Table",{attrs:{columns:t.columns,data:t.lists}}),t._v(" "),r("div",{staticClass:"pagination"},[r("Page",{attrs:{total:t.totalCount,"page-size":t.pageSize,"show-elevator":"","show-sizer":""},on:{"on-change":t.pageChange,"on-page-size-change":t.pageSizeChange}})],1)],1)]),t._v(" "),r("Drawer",{attrs:{width:"450",title:"收益筛选","mask-closable":!1},on:{"on-close":function(e){t.clearFilter("filterForm")}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}},[r("div",{staticClass:"clearfix mb-15"},[r("div",{staticClass:"pull-left"},[r("Button",{on:{click:function(e){t.clearFilter("filterForm")}}},[t._v("清空筛选条件")])],1),t._v(" "),r("div",{staticClass:"pull-right"},[r("Button",{attrs:{type:"primary"},on:{click:t.sureFilter}},[t._v("确定筛选")])],1)]),t._v(" "),r("Form",{ref:"filterForm",attrs:{model:t.filterForm,"label-position":"top"}},[r("FormItem",{attrs:{label:"服务类型",prop:"repairCategoryId"}},[r("Select",{model:{value:t.filterForm.repairCategoryId,callback:function(e){t.$set(t.filterForm,"repairCategoryId",e)},expression:"filterForm.repairCategoryId"}},t._l(t.repairTypeLists,function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}))],1),t._v(" "),r("FormItem",{attrs:{label:"工单时间",prop:"dateRange"}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"daterange"},on:{"on-change":t.dateRangeChange},model:{value:t.filterForm.dateRange,callback:function(e){t.$set(t.filterForm,"dateRange",e)},expression:"filterForm.dateRange"}})],1),t._v(" "),r("FormItem",{attrs:{label:"工单状态",prop:"orderStateList"}},[r("CheckboxGroup",{model:{value:t.filterForm.orderStateList,callback:function(e){t.$set(t.filterForm,"orderStateList",e)},expression:"filterForm.orderStateList"}},[r("Checkbox",{attrs:{label:"ASSIGNED"}},[t._v("待分配")]),t._v(" "),r("Checkbox",{attrs:{label:"WAIT_DOOR"}},[t._v("待上门")]),t._v(" "),r("Checkbox",{attrs:{label:"WAITING_DOOR"}},[t._v("已上门")]),t._v(" "),r("Checkbox",{attrs:{label:"STAY_PAY"}},[t._v("待付款")]),t._v(" "),r("Checkbox",{attrs:{label:"WAIT_SERVICE"}},[t._v("待服务")]),t._v(" "),r("Checkbox",{attrs:{label:"FINISH"}},[t._v("已完成")]),t._v(" "),r("Checkbox",{attrs:{label:"AFTER_SALE"}},[t._v("售后中")]),t._v(" "),r("Checkbox",{attrs:{label:"CANCEL"}},[t._v("已取消")]),t._v(" "),r("Checkbox",{attrs:{label:"CLOSED"}},[t._v("已关闭")]),t._v(" "),r("Checkbox",{attrs:{label:"EXCEPTION"}},[t._v("异常")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var n=r("VU/8")(l,s,!1,function(t){r("oS7P")},"data-v-51125ff1",null);e.default=n.exports},oS7P:function(t,e){}});