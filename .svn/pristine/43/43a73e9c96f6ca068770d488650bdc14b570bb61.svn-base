webpackJsonp([30],{WgNQ:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("Dd8w"),s=i.n(a),r=i("TVG1"),n={name:"visite",data:function(){var t=this;return{waiting:function(e){return e("div",[e("span","待回访"),e("Badge",{props:{count:t.stateCount.N},style:{marginLeft:"10px"}})])},visited:function(e){return e("div",[e("span","已回访"),e("Badge",{props:{count:t.stateCount.Y},style:{marginLeft:"10px"}})])},filter:!1,tabActive:"visited",lists:[],stationLists:[],stateCount:{Y:0,N:0},pageNo:1,pageSize:10,totalCount:0,filterForm:{},isReturnVisit:"Y"}},methods:{getLists:function(t){var e=this,i="pageNo="+this.pageNo+"&pageSize="+this.pageSize+"&isReturnVisit="+this.isReturnVisit,a=r.a.formatterParams(t);this.$http.post("/repair/return/visit/list?"+i+"&"+a).then(function(t){if(0===t.data.code){var i=t.data.data;e.pageSize=i.pageSize,e.totalCount=i.totalCount,e.lists=i.list,e.filter=!1}else console.log("回访列表获取失败："+t.data.msg)})},pageChange:function(t){this.pageNo=t;switch(this.tabActive){case"visited":"Y";break;case"waiting":"N"}this.getLists()},pageSizeChange:function(t){this.pageSize=t;switch(this.tabActive){case"visited":"Y";break;case"waiting":"N"}this.getLists()},dateRangeChange:function(t){this.filterForm.startTime=t[0],this.filterForm.endTime=t[1]},clearFilter:function(){this.filterForm={},this.filter=!1,this.getLists()},sureFilter:function(){var t=s()({},this.filterForm);delete t.dateRange,this.getLists(t)},getCount:function(){var t=this;this.$http.get("/repair/return/visit/state/count").then(function(e){0===e.data.code&&e.data.data.map(function(e){switch(e.state){case"N":t.stateCount.N=e.countNum;break;case"Y":t.stateCount.Y=e.countNum}})})}},mounted:function(){var t=this;this.getLists(),this.getCount(),r.a.getStationLists(function(e){t.stationLists=e})},watch:{tabActive:function(t){this.filterForm={},this.isReturnVisit="waiting"===t?"N":"Y",this.pageNo=1,this.pageSize=10,this.lists=[],this.getLists()}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Card",{staticStyle:{"padding-bottom":"30px"}},[i("Tabs",{attrs:{animated:!1},model:{value:t.tabActive,callback:function(e){t.tabActive=e},expression:"tabActive"}},[i("TabPane",{attrs:{label:t.visited,name:"visited"}},[i("div",{staticClass:"mb-15 clearfix"},[i("div",{staticClass:"pull-right"},[i("Button",{attrs:{type:"primary"},on:{click:function(e){t.filter=!0}}},[t._v("筛选")])],1)])]),t._v(" "),i("TabPane",{attrs:{label:t.waiting,name:"waiting"}},[i("div",{staticClass:"mb-15 clearfix"},[i("div",{staticClass:"pull-right"},[i("Button",{attrs:{type:"primary"},on:{click:function(e){t.filter=!0}}},[t._v("筛选")])],1)])])],1),t._v(" "),i("table",{staticClass:"native-table"},[i("thead",[i("tr",[i("th",[t._v("工单编号")]),t._v(" "),i("th",[t._v("售后回访")]),t._v(" "),i("th",[t._v("工单状态")]),t._v(" "),i("th",[t._v("报修类型")]),t._v(" "),i("th",[t._v("服务网点")]),t._v(" "),i("th",[t._v("接单师傅")]),t._v(" "),i("th",[t._v("创建日期")]),t._v(" "),"visited"===t.tabActive?i("th",[t._v("回访结果")]):t._e(),t._v(" "),"visited"===t.tabActive?i("th",[t._v("操作")]):t._e()])]),t._v(" "),i("tbody",t._l(t.lists,function(e){return i("tr",{key:e.id},[i("td",[t._v(t._s(e.orderSn))]),t._v(" "),i("td",[t._v(t._s(e.afterSaleVisit))]),t._v(" "),i("td",[t._v(t._s(e.orderState))]),t._v(" "),i("td",[t._v(t._s(e.repairCategoryName))]),t._v(" "),i("td",[t._v(t._s(e.repairStationName))]),t._v(" "),i("td",[t._v(t._s(e.receiveUserName))]),t._v(" "),i("td",[t._v(t._s(e.createTime))]),t._v(" "),"visited"===t.tabActive?i("td",[t._v(t._s(e.returnVisitResult))]):t._e(),t._v(" "),"visited"===t.tabActive?i("td",[i("Button",{attrs:{type:"text"},on:{click:function(i){t.$router.push({name:"orderDetail",query:{id:e.orderId}})}}},[t._v("查看")])],1):t._e()])}))]),t._v(" "),t.totalCount>0?i("div",{staticClass:"pagination"},[i("Page",{attrs:{total:t.totalCount,"show-sizer":"","show-elevator":""},on:{"on-change":t.pageChange,"on-page-size-change":t.pageSizeChange}})],1):t._e(),t._v(" "),i("Drawer",{attrs:{width:"450",title:"工单筛选"},on:{"on-close":t.clearFilter},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}},[i("div",{staticClass:"clearfix mb-15"},[i("div",{staticClass:"pull-left"},[i("Button",{on:{click:t.clearFilter}},[t._v("清空筛选条件")])],1),t._v(" "),i("div",{staticClass:"pull-right"},[i("Button",{attrs:{type:"primary"},on:{click:t.sureFilter}},[t._v("确定")])],1)]),t._v(" "),i("Form",{ref:"filterForm",attrs:{model:t.filterForm}},[i("FormItem",{attrs:{label:"回访结果"}},[i("Select",{attrs:{clearable:!0},model:{value:t.filterForm.returnVisitResult,callback:function(e){t.$set(t.filterForm,"returnVisitResult",e)},expression:"filterForm.returnVisitResult"}},[i("Option",{attrs:{value:"PASS"}},[t._v("通过")]),t._v(" "),i("Option",{attrs:{value:"NOT_PASS"}},[t._v("不通过")])],1)],1),t._v(" "),i("FormItem",{attrs:{label:"工单编号"}},[i("Input",{model:{value:t.filterForm.orderSn,callback:function(e){t.$set(t.filterForm,"orderSn",e)},expression:"filterForm.orderSn"}})],1),t._v(" "),i("FormItem",{attrs:{label:"创建时间"}},[i("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"daterange"},on:{"on-change":t.dateRangeChange},model:{value:t.filterForm.dateRange,callback:function(e){t.$set(t.filterForm,"dateRange",e)},expression:"filterForm.dateRange"}})],1),t._v(" "),i("FormItem",{attrs:{label:"服务网点"}},[i("Select",{attrs:{clearable:!0},model:{value:t.filterForm.repairStationId,callback:function(e){t.$set(t.filterForm,"repairStationId",e)},expression:"filterForm.repairStationId"}},t._l(t.stationLists,function(e){return i("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}))],1),t._v(" "),i("FormItem",{attrs:{label:"售后回访"}},[i("Select",{attrs:{clearable:!0},model:{value:t.filterForm.afterSaleVisit,callback:function(e){t.$set(t.filterForm,"afterSaleVisit",e)},expression:"filterForm.afterSaleVisit"}},[i("Option",{attrs:{value:"AFTER_SALE"}},[t._v("是")]),t._v(" "),i("Option",{attrs:{value:"ORDER"}},[t._v("否")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var o=i("VU/8")(n,l,!1,function(t){i("nPll")},"data-v-63a9c941",null);e.default=o.exports},nPll:function(t,e){}});