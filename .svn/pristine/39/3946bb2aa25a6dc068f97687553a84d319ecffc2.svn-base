webpackJsonp([5],{deSX:function(e,t){},h59p:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={name:"role-control",data:function(){return{loadingSend:!1,type:1,id:"",viewInfo:!1,roleInfo:{name:"",description:"",resourceList:"",id:"",callCenterId:""},authLists:[],authListsCheck:[],roleInfoRule:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],description:[{required:!0,message:"请输入角色描述",trigger:"blur"}]}}},methods:{checkNodes:function(e){this.authListsCheck=e.map(function(e){return e.id})},goback:function(){this.$router.back()},getRoleInfo:function(e){var t=this;this.$http.get("/role/info?id="+e).then(function(e){0===e.data.code?(t.roleInfo=e.data.data,t.authListsCheck=e.data.data.resourceList,t.getAuth()):console.log(e.data.msg)})},saveThis:function(){var e=this;this.loadingSend=!0;var t=this.type,n="",o=this.roleInfo;n=1===t?"/role/add":"/role/edit",this.$refs.roleInfo.validate(function(t){t?e.$http.post(n,{name:o.name,description:o.description,resourceList:e.authListsCheck,id:o.id}).then(function(t){0===t.data.code?(e.$Message.success("保存成功"),e.$router.push({name:"role"})):e.$Message.error(t.data.msg),e.loadingSend=!1}):e.loadingSend=!1})},getAuth:function(){var e=this;this.$http.get("/resource/list").then(function(t){if(0===t.data.code){var n=t.data.data,o=e.authListsCheck,i={},a=e;i=o.length>0?e.iteratorTree(n,function(e){e.title=e.name,e.expand=!0,e.disabled=a.viewInfo,o.forEach(function(t){e.id===t&&(e.checked=!0)})}):e.iteratorTree(n,function(e){e.title=e.name,e.expand=!0,e.disabled=a.viewInfo}),e.authLists=i}else console.log(t.data.msg)})},iteratorTree:function(e,t){var n=this,o=[],i=this;return e instanceof Array&&(o=e.map(function(e){return"function"==typeof t&&t(e),e.disabled=i.viewInfo,e.children&&e.children.length>0&&n.iteratorTree(e.children,t),e})),o}},mounted:function(){this.type=this.$route.query.type,this.id=this.$route.query.id,1*this.type==0?this.getRoleInfo(this.id):1*this.type==2?(this.viewInfo=!0,this.getRoleInfo(this.id)):this.getAuth()},watch:{viewInfo:function(e){this.getAuth()}}},i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Card",{staticStyle:{"padding-bottom":"30px"}},[n("div",{staticClass:"clearfix mb-15"},[n("div",{staticClass:"pull-left"},[n("Button",{attrs:{type:"primary"},on:{click:function(t){e.goback()}}},[e._v("返回上一页")])],1),e._v(" "),n("div",{staticClass:"pull-right"},[e.viewInfo?e._e():n("Button",{on:{click:e.goback}},[e._v("取消")]),e._v(" "),e.viewInfo?n("Button",{attrs:{type:"primary"},on:{click:function(t){e.viewInfo=!1}}},[e._v("编辑")]):e._e(),e._v(" "),e.viewInfo?e._e():n("Button",{attrs:{loading:e.loadingSend,type:"primary"},on:{click:e.saveThis}},[e._v("保存")])],1)]),e._v(" "),n("div",{staticClass:"role-panel"},[n("Form",{ref:"roleInfo",attrs:{model:e.roleInfo,"label-position":"top",rules:e.roleInfoRule}},[n("Row",{attrs:{gutter:40}},[n("Col",{attrs:{span:"12"}},[n("h4",[e._v("基础信息")]),e._v(" "),n("FormItem",{attrs:{label:"角色名称",prop:"name"}},[n("Input",{attrs:{disabled:e.viewInfo},model:{value:e.roleInfo.name,callback:function(t){e.$set(e.roleInfo,"name",t)},expression:"roleInfo.name"}})],1),e._v(" "),n("FormItem",{attrs:{label:"角色描述",prop:"description"}},[n("Input",{attrs:{maxlength:150,placeholder:"最多150字",disabled:e.viewInfo,type:"textarea",rows:10},model:{value:e.roleInfo.description,callback:function(t){e.$set(e.roleInfo,"description",t)},expression:"roleInfo.description"}})],1)],1),e._v(" "),n("Col",{attrs:{span:"12"}},[n("h4",[e._v("功能权限")]),e._v(" "),n("Tree",{ref:"authTree",attrs:{data:e.authLists,"show-checkbox":"",multiple:""},on:{"on-check-change":e.checkNodes}})],1)],1)],1)],1)])],1)},staticRenderFns:[]};var a=n("VU/8")(o,i,!1,function(e){n("deSX")},"data-v-4babd55c",null);t.default=a.exports}});