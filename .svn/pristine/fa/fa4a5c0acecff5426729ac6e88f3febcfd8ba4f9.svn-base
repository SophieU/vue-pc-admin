{"version":3,"sources":["webpack:///src/pages/source/new-out.vue","webpack:///./src/pages/source/new-out.vue?d963","webpack:///./src/pages/source/new-out.vue"],"names":["new_out","name","data","showModal","outputForm","sn","outputType","outputFormRule","required","message","trigger","searchForm","categoryId","searchKey","pageSize","pageNo","repairType","materialCheckedlists","materialTotal","materialLists","materialCheck","materialCheckTemp","methods","deleteMater","ind","this","splice","modalVisible","visible","materialPageChange","val","pageSIze","searchMaterial","sureMaterial","checkLists","checkTemp","map","item","num","amount","concat","_this","param","util","formatterParams","$http","post","then","res","code","checkedLists","list","index","forEach","checkItem","id","checked","hasChecked","lists","console","log","compareChoosed","totalCount","msg","numChange","price","getRepairType","_this2","get","checkChange","_this3","split","parseInt","push","hasCheck","check","disabled","sureOut","_this4","form","detailList","detailValid","notValidType","notValid","$refs","validate","valid","materialId","extends_default","$Message","success","$router","error","mounted","source_new_out","render","_vm","_h","$createElement","_c","_self","staticStyle","padding-bottom","staticClass","on","click","$event","back","_v","attrs","type","ref","margin-right","model","rules","label-width","label","prop","value","callback","$$v","$set","expression","_l","material","key","_s","spec","unit","width","step","min","placeholder","on-change","indexOf","_e","title","on-visible-change","inline","repair","true-value","false-value","size","total","slot","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/36.4004de76368814f82148.js","sourcesContent":["<style scoped lang=\"scss\">\n  @import \"./source.scss\";\n</style>\n<template>\n    <Card style=\"padding-bottom:30px;\">\n      <div class=\"clearfix mb-15\">\n        <div class=\"pull-left\">\n          <Button @click=\"$router.back()\">返回上一页</Button>\n        </div>\n        <div class=\"pull-right\">\n          <Button @click=\"sureOut\" type=\"primary\">确定出库</Button>\n        </div>\n      </div>\n\n      <Form ref=\"outForm\" :model=\"outputForm\" :rules=\"outputFormRule\" :label-width=\"100\" style=\"margin-right:200px;\">\n        <FormItem label=\"出库类型\" prop=\"outputType\">\n          <Select v-model=\"outputForm.outputType\" class=\"w300\">\n            <Option value=\"REFUND\">退货</Option>\n          </Select>\n        </FormItem>\n        <FormItem label=\"原始单号\">\n          <Input v-model=\"outputForm.sn\" class=\"w400\"/>\n        </FormItem>\n        <FormItem label=\"辅材\">\n          <Button @click=\"showModal=true\">添加辅材</Button>\n        </FormItem>\n      </Form>\n      <div class=\"table-wrapper\">\n        <table class=\"native-table\">\n          <thead>\n          <tr>\n            <th>辅材名称</th>\n            <th>型号</th>\n            <th>单位</th>\n            <th>单价</th>\n            <th>数量  <span class=\"text-red\">*</span></th>\n            <th>出库成本</th>\n            <th>操作</th>\n          </tr>\n          </thead>\n          <tbody>\n          <tr v-for=\"(material,index) in materialCheckedlists\" :key=\"index\">\n            <td>{{material.name}}</td>\n            <td>{{material.spec}}</td>\n            <td>{{material.unit}}</td>\n            <td>{{material.price}}</td>\n            <td style=\"width:200px\">\n              <InputNumber @on-change=\"numChange(material.num,index)\" style=\"width:80%;\" v-model=\"material.num\" :step=\"1\" :min=\"1\" placeholder=\"请输入数量\"></InputNumber>\n              <p v-if=\"material.notValid&&material.notValidType.indexOf('num')>-1\" class=\"text-red\">请输入单价</p>\n            </td>\n            <td>{{material.amount}}</td>\n            <td>\n              <Button @click=\"deleteMater(index)\" type=\"text\" class=\"text-red\">删除</Button>\n            </td>\n          </tr>\n          </tbody>\n        </table>\n      </div>\n      <!--辅材弹窗-->\n      <!--辅材弹窗-->\n      <Modal title=\"选择辅材\" v-model=\"showModal\" width=\"650\" @on-visible-change=\"modalVisible\">\n        <div>\n          <div class=\"mb-15\">\n            <Form ref=\"searchForm\" :model=\"searchForm\" inline :label-width=\"70\">\n              <FormItem label=\"辅材类别\">\n                <Select style=\"width:160px ;\" v-model=\"searchForm.categoryId\">\n                  <Option v-for=\"repair in repairType\" :value=\"repair.id\" :key=\"repair.id\">{{repair.name}}</Option>\n                </Select>\n              </FormItem>\n              <FormItem label=\"关键字\">\n                <Input v-model=\"searchForm.searchKey\" placeholder=\"请输入辅材名称或型号\"/>\n              </FormItem>\n              <Button @click=\"searchMaterial\" type=\"primary\">搜索</Button>\n            </Form>\n          </div>\n          <div class=\"table-wrapper\">\n            <table class=\"native-table\">\n              <thead>\n              <tr>\n                <th>辅材名称</th>\n                <th>型号</th>\n                <th>单位</th>\n                <th>操作</th>\n              </tr>\n              </thead>\n              <tbody>\n              <tr v-for=\"(material,index) in materialLists\" :key=\"material.id\">\n                <td>{{material.name}}</td>\n                <td>{{material.spec}}</td>\n                <td>{{material.unit}}</td>\n                <td>\n                  <!--<Button type=\"text\" class=\"text-blue\">选择</Button>-->\n                  <Checkbox :disabled=\"material.disabled\" v-model=\"material.checked\" @on-change=\"checkChange\" :true-value=\"1+'-'+index\" :false-value=\"0+'-'+index\">选择</Checkbox>\n                </td>\n              </tr>\n              </tbody>\n            </table>\n            <div class=\"pagination\">\n              <Page @on-change=\"materialPageChange\" size=\"small\" :total=\"materialTotal\" ></Page>\n            </div>\n          </div>\n        </div>\n        <div slot=\"footer\">\n          <Button @click=\"showModal=false\">关闭</Button>\n          <Button type=\"primary\" @click=\"sureMaterial\">确认</Button>\n        </div>\n      </Modal>\n\n    </Card>\n</template>\n\n<script>\n  import util from '../../libs/util'\n    export default {\n        name: \"new-out\",\n      data(){\n          return {\n            showModal:false,\n            outputForm:{\n              sn:'',\n              outputType:'',\n            },\n            outputFormRule:{\n              outputType:[{required:true,message:'请选择出库类型',trigger:'change'}]\n            },\n            searchForm:{\n              categoryId:'',\n              searchKey:'',\n              pageSize:5,\n              pageNo:1,\n            },\n            repairType:[],//报修分类列表\n            materialCheckedlists:[\n\n            ],\n            materialTotal:0, //辅材搜索，列表总条数\n            materialLists:[], //辅材列表\n            materialCheck:[], //弹窗已选辅材\n            materialCheckTemp:[], //弹窗已选辅材\n          }\n      },\n      methods:{\n        deleteMater(ind){\n          this.materialCheckedlists.splice(ind,1);\n        },\n        //弹窗显示状态变化\n        modalVisible(visible){\n          /*\n          *  materialLists:[], //辅材列表\n          *    materialCheckedlists  //界面已选辅材\n          * */\n          if(!visible){\n            this.materialCheckTemp=[];\n            this.materialLists=[];\n            this.materialCheck=this.materialCheckedlists;\n            this. searchForm={\n              categoryId:'',\n              searchKey:'',\n              pageSize:5,\n              pageNo:1,\n            };\n          }\n        },\n        //辅材分页切换\n        materialPageChange(val){\n          this.searchForm.pageSIze=val;\n          this.searchMaterial();\n        },\n        //确定弹窗\n        sureMaterial(){\n          let checkLists = this.materialCheckTemp;\n          this.showModal=false;\n          let checkTemp = checkLists.map(item=>{\n            item.num=null;\n            item.amount=null;\n            // if(!item.price){\n            //   item.price=null;\n            // }\n            return item;\n          });\n          this.materialCheckedlists = this.materialCheckedlists.concat(checkTemp);\n\n        },\n        //搜索辅材\n        searchMaterial(){\n          let param =util.formatterParams(this.searchForm);\n          this.$http.post(`/repair/material/selectList?${param}`)\n            .then(res=>{\n              if(res.data.code===0){\n                let data = res.data.data;\n                let checkedLists = this.materialCheck;\n                // 用于标记已选辅材\n                this.materialLists = data.list.map((item,index)=>{\n                  checkedLists.forEach(checkItem=>{\n                    if(item.id===checkItem.id){\n                      item.checked='1-'+index;\n                    }\n                  });\n                  if(!item.checked){\n                    item.checked='0-'+index;\n                  }\n                  return item;\n                });\n                // 禁用已选项\n                let hasChecked = this.materialCheck;\n                let lists = this.materialLists;\n                console.log(hasChecked)\n                this.materialLists=this.compareChoosed(hasChecked,lists);\n\n                //设置页码\n                this.materialTotal = data.totalCount\n              }else{\n                console.log('辅材搜索失败：'+res.data.msg)\n              }\n            })\n        },\n        //数量输入改变\n        numChange(val,index){\n          this.materialCheckedlists=this.materialCheckedlists.map((item,ind)=>{\n            if(index===ind&&item.num>0){\n              item.amount=item.price*item.num\n            }\n            return item;\n          });\n        },\n        //获取辅材分类\n        getRepairType(){\n          this.$http.get(`/repair/category/list`)\n            .then(res=>{\n              if(res.data.code===0){\n                this.repairType=res.data.data;\n              }else{\n                console.log('报修分类获取失败：'+res.data.msg);\n              }\n            })\n        },\n        //弹窗选择辅材交互\n        checkChange(val){\n          /**\n           * 辅材选择切换：val构成： boolean-index\n           */\n          let materialLists = this.materialLists;\n          val = val.split('-');\n          let checked = val[0];\n          let index = parseInt(val[1]);\n          if(checked==='1'){\n            this.materialCheckTemp.push(materialLists[index])\n          }else{\n            this.materialCheckTemp.map((item,ind)=>{\n              if(item.id===materialLists[index].id){\n                this.materialCheckTemp.splice(ind,1);\n              }\n            });\n          }\n\n        },\n        /*用于比对已选辅材*/\n        compareChoosed(hasCheck,lists){\n          lists=lists.map(item=>{\n            hasCheck.forEach(check=>{\n              if(item.id===check.id){\n                item.disabled=true;\n              }\n            });\n            if(!item.disabled){\n              item.disabled=false;\n            }\n            return item;\n          });\n          return lists;\n        },\n        sureOut(){\n          let form = this.outputForm;\n          let detailList = this.materialCheckedlists;\n          let detailValid = true;\n          this.materialCheckedlists=detailList.map(item=>{\n            item.notValidType=[];\n            item.notValid=false;\n            if(!item.num){\n              detailValid=false;\n              item.notValid=true;\n              item.notValidType.push('num');\n            }\n            return item;\n          });\n          if(!detailValid) return;\n          this.$refs['outForm'].validate(valid=>{\n            if(valid){\n              form.detailList=detailList.map(item=>{\n                let data = {\n                  materialId:item.id,\n                  price:item.price,\n                  amount:item.amount,\n                  num:item.num\n                };\n                return data;\n              });\n              this.$http.post(`/repair/material/output/order/add`,{\n                ...form\n              }).then(res=>{\n                if(res.data.code===0){\n                  this.$Message.success('保存成功');\n                  this.$router.push({name:'output'})\n                }else{\n                  this.$Message.error(res.data.msg);\n                }\n              })\n\n            }\n          })\n        }\n      },\n      mounted(){\n          this.getRepairType();\n      }\n    }\n</script>\n\n\n\n\n\n// WEBPACK FOOTER //\n// src/pages/source/new-out.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Card',{staticStyle:{\"padding-bottom\":\"30px\"}},[_c('div',{staticClass:\"clearfix mb-15\"},[_c('div',{staticClass:\"pull-left\"},[_c('Button',{on:{\"click\":function($event){_vm.$router.back()}}},[_vm._v(\"返回上一页\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"pull-right\"},[_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.sureOut}},[_vm._v(\"确定出库\")])],1)]),_vm._v(\" \"),_c('Form',{ref:\"outForm\",staticStyle:{\"margin-right\":\"200px\"},attrs:{\"model\":_vm.outputForm,\"rules\":_vm.outputFormRule,\"label-width\":100}},[_c('FormItem',{attrs:{\"label\":\"出库类型\",\"prop\":\"outputType\"}},[_c('Select',{staticClass:\"w300\",model:{value:(_vm.outputForm.outputType),callback:function ($$v) {_vm.$set(_vm.outputForm, \"outputType\", $$v)},expression:\"outputForm.outputType\"}},[_c('Option',{attrs:{\"value\":\"REFUND\"}},[_vm._v(\"退货\")])],1)],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"原始单号\"}},[_c('Input',{staticClass:\"w400\",model:{value:(_vm.outputForm.sn),callback:function ($$v) {_vm.$set(_vm.outputForm, \"sn\", $$v)},expression:\"outputForm.sn\"}})],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"辅材\"}},[_c('Button',{on:{\"click\":function($event){_vm.showModal=true}}},[_vm._v(\"添加辅材\")])],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"table-wrapper\"},[_c('table',{staticClass:\"native-table\"},[_c('thead',[_c('tr',[_c('th',[_vm._v(\"辅材名称\")]),_vm._v(\" \"),_c('th',[_vm._v(\"型号\")]),_vm._v(\" \"),_c('th',[_vm._v(\"单位\")]),_vm._v(\" \"),_c('th',[_vm._v(\"单价\")]),_vm._v(\" \"),_c('th',[_vm._v(\"数量  \"),_c('span',{staticClass:\"text-red\"},[_vm._v(\"*\")])]),_vm._v(\" \"),_c('th',[_vm._v(\"出库成本\")]),_vm._v(\" \"),_c('th',[_vm._v(\"操作\")])])]),_vm._v(\" \"),_c('tbody',_vm._l((_vm.materialCheckedlists),function(material,index){return _c('tr',{key:index},[_c('td',[_vm._v(_vm._s(material.name))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(material.spec))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(material.unit))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(material.price))]),_vm._v(\" \"),_c('td',{staticStyle:{\"width\":\"200px\"}},[_c('InputNumber',{staticStyle:{\"width\":\"80%\"},attrs:{\"step\":1,\"min\":1,\"placeholder\":\"请输入数量\"},on:{\"on-change\":function($event){_vm.numChange(material.num,index)}},model:{value:(material.num),callback:function ($$v) {_vm.$set(material, \"num\", $$v)},expression:\"material.num\"}}),_vm._v(\" \"),(material.notValid&&material.notValidType.indexOf('num')>-1)?_c('p',{staticClass:\"text-red\"},[_vm._v(\"请输入单价\")]):_vm._e()],1),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(material.amount))]),_vm._v(\" \"),_c('td',[_c('Button',{staticClass:\"text-red\",attrs:{\"type\":\"text\"},on:{\"click\":function($event){_vm.deleteMater(index)}}},[_vm._v(\"删除\")])],1)])}))])]),_vm._v(\" \"),_c('Modal',{attrs:{\"title\":\"选择辅材\",\"width\":\"650\"},on:{\"on-visible-change\":_vm.modalVisible},model:{value:(_vm.showModal),callback:function ($$v) {_vm.showModal=$$v},expression:\"showModal\"}},[_c('div',[_c('div',{staticClass:\"mb-15\"},[_c('Form',{ref:\"searchForm\",attrs:{\"model\":_vm.searchForm,\"inline\":\"\",\"label-width\":70}},[_c('FormItem',{attrs:{\"label\":\"辅材类别\"}},[_c('Select',{staticStyle:{\"width\":\"160px\"},model:{value:(_vm.searchForm.categoryId),callback:function ($$v) {_vm.$set(_vm.searchForm, \"categoryId\", $$v)},expression:\"searchForm.categoryId\"}},_vm._l((_vm.repairType),function(repair){return _c('Option',{key:repair.id,attrs:{\"value\":repair.id}},[_vm._v(_vm._s(repair.name))])}))],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"关键字\"}},[_c('Input',{attrs:{\"placeholder\":\"请输入辅材名称或型号\"},model:{value:(_vm.searchForm.searchKey),callback:function ($$v) {_vm.$set(_vm.searchForm, \"searchKey\", $$v)},expression:\"searchForm.searchKey\"}})],1),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.searchMaterial}},[_vm._v(\"搜索\")])],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"table-wrapper\"},[_c('table',{staticClass:\"native-table\"},[_c('thead',[_c('tr',[_c('th',[_vm._v(\"辅材名称\")]),_vm._v(\" \"),_c('th',[_vm._v(\"型号\")]),_vm._v(\" \"),_c('th',[_vm._v(\"单位\")]),_vm._v(\" \"),_c('th',[_vm._v(\"操作\")])])]),_vm._v(\" \"),_c('tbody',_vm._l((_vm.materialLists),function(material,index){return _c('tr',{key:material.id},[_c('td',[_vm._v(_vm._s(material.name))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(material.spec))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(material.unit))]),_vm._v(\" \"),_c('td',[_c('Checkbox',{attrs:{\"disabled\":material.disabled,\"true-value\":1+'-'+index,\"false-value\":0+'-'+index},on:{\"on-change\":_vm.checkChange},model:{value:(material.checked),callback:function ($$v) {_vm.$set(material, \"checked\", $$v)},expression:\"material.checked\"}},[_vm._v(\"选择\")])],1)])}))]),_vm._v(\" \"),_c('div',{staticClass:\"pagination\"},[_c('Page',{attrs:{\"size\":\"small\",\"total\":_vm.materialTotal},on:{\"on-change\":_vm.materialPageChange}})],1)])]),_vm._v(\" \"),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('Button',{on:{\"click\":function($event){_vm.showModal=false}}},[_vm._v(\"关闭\")]),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.sureMaterial}},[_vm._v(\"确认\")])],1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-42665e2a\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/source/new-out.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-42665e2a\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./new-out.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./new-out.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./new-out.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-42665e2a\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./new-out.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-42665e2a\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/source/new-out.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}