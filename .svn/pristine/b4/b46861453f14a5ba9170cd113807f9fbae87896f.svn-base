webpackJsonp([44],{MKC6:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("Dd8w"),i=a.n(r),n=a("TVG1"),l={name:"staff-order-income",data:function(){var t=this;return{filter:!1,id:"",orderTotal:"",columns:[{title:"工单号",key:"orderSn",align:"center"},{title:"服务类型",key:"repairCategoryName",align:"center"},{title:"创建时间",key:"createTime",align:"center"},{title:"上门费收益",key:"dtdServiceEarning",align:"center"},{title:"服务费收益",key:"serviceEarning",align:"center"},{title:"辅材费收益",key:"materialEarning",align:"center"},{title:"收益总计",key:"totalEarning",align:"center"},{title:"操作",align:"center",render:function(e,a){var r=t;return e("Button",{props:{type:"text"},on:{click:function(){var t=a.row.id;r.$router.push({name:"orderDetail",query:{id:t}})}}},"查看订单")}}],lists:[],pageNo:1,pageSize:10,totalCount:0,repairTypeLists:[],filterForm:{repairCategoryId:"",dateRange:[],startDate:"",endDate:""},filterDateRange:null}},methods:{dateRangeChange:function(t){this.filterForm.startDate=t[0],this.filterForm.endDate=t[1]},getRepairType:function(){var t=this;n.a.getRepairType(function(e){t.repairTypeLists=e})},getLists:function(t){var e=this,a=this.id,r="pageNo="+this.pageNo+"&pageSize="+this.pageSize+"&id="+a,i=n.a.formatterParams(t);this.$http.post("/server/order/earning/list?"+r+"&"+i).then(function(a){if(0===a.data.code){var r=a.data.data;e.lists=r.list,e.pageSize=r.pageSize,e.totalCount=r.totalCount,e.filter=!1,t&&t.startDate?e.filterDateRange=[t.startDate,t.endDate]:e.filterDateRange=null}else console.log("工单收益列表失败："+a.data.msg)})},getOrderTotal:function(t){var e=this;this.$http.get("/server/order/earning/count?id="+t).then(function(t){0===t.data.code?e.orderTotal=t.data.data:console.log("工单统计信息失败："+t.data.msg)})},clearFilter:function(t){this.$refs[t].resetFields(),this.filterDateRange=null},sureFilter:function(){var t=i()({},this.filterForm);delete t.dateRange;var e={};for(var a in t)(t[a].length>0||t[a]>0)&&(e[a]=t[a]);console.log(t),this.getLists(t)},pageChange:function(t){this.pageNo=t,this.getLists()},pageSizeChange:function(t){this.pageSize=t,this.getLists()},exportExcel:function(){var t=i()({},this.filterForm);delete t.dateRange;var e=n.a.formatterParams(t),a=this.id;this.$http.post("/server/order/earning/list/export?id="+a+"&"+e,null,{responseType:"blob"}).then(function(t){n.a.downloadExcel(t)})}},mounted:function(){this.id=this.$route.query.id,this.getOrderTotal(this.id),this.getLists(),this.getRepairType()}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",{staticClass:"mb-15"},[a("p",{attrs:{slot:"title"},slot:"title"},[t._v("工单统计")]),t._v(" "),a("table",{staticClass:"native-table mb-15"},[a("thead",[a("tr",[a("th",[t._v("历史工单总数")]),t._v(" "),a("th",[t._v("历史收益总计")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v(t._s(t.orderTotal.totalOrderNum))]),t._v(" "),a("td",[t._v(t._s(t.orderTotal.totalEarning))])])])]),t._v(" "),a("table",{staticClass:"native-table mb-15"},[a("thead",[a("tr",[a("th",[t._v("本月工单总数")]),t._v(" "),a("th",[t._v("本月收益总计")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v(t._s(t.orderTotal.currentMonthOrderNum))]),t._v(" "),a("td",[t._v(t._s(t.orderTotal.currentMonthEarning))])])])])]),t._v(" "),a("Card",[a("p",{attrs:{slot:"title"},slot:"title"},[t._v("工单列表")]),t._v(" "),a("div",{staticClass:"clearfix mb-15"},[t.filterDateRange?a("div",{staticClass:"pull-left"},[a("span",[t._v("时间："+t._s(t.filterDateRange[0])+" 至 "+t._s(t.filterDateRange[1]))])]):t._e(),t._v(" "),a("div",{staticClass:"pull-right"},[a("Button",{on:{click:function(e){t.filter=!0}}},[t._v("筛选")]),t._v(" "),a("Button",{attrs:{type:"primary"},on:{click:t.exportExcel}},[t._v("excel导出")])],1)]),t._v(" "),a("div",{staticClass:"table-wrapper"},[a("Table",{attrs:{columns:t.columns,data:t.lists}}),t._v(" "),a("div",{staticClass:"pagination"},[a("Page",{attrs:{total:t.totalCount,"show-sizer":"","show-elevator":""},on:{"on-change":t.pageChange,"on-page-size-change":t.pageSizeChange}})],1)],1)]),t._v(" "),a("Drawer",{attrs:{width:"450",title:"收益筛选"},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}},[a("div",{staticClass:"clearfix mb-15"},[a("div",{staticClass:"pull-left"},[a("Button",{on:{click:function(e){t.clearFilter("filterForm")}}},[t._v("清空筛选条件")])],1),t._v(" "),a("div",{staticClass:"pull-right"},[a("Button",{attrs:{type:"primary"},on:{click:t.sureFilter}},[t._v("确定筛选")])],1)]),t._v(" "),a("i-form",{ref:"filterForm",attrs:{model:t.filterForm,"label-position":"top"}},[a("form-item",{attrs:{label:"服务分类"}},[a("Select",{model:{value:t.filterForm.repairCategoryId,callback:function(e){t.$set(t.filterForm,"repairCategoryId",e)},expression:"filterForm.repairCategoryId"}},t._l(t.repairTypeLists,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}))],1),t._v(" "),a("form-item",{attrs:{label:"工单时间"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"daterange"},on:{"on-change":t.dateRangeChange},model:{value:t.filterForm.dateRange,callback:function(e){t.$set(t.filterForm,"dateRange",e)},expression:"filterForm.dateRange"}})],1)],1)],1)],1)},staticRenderFns:[]};var o=a("VU/8")(l,s,!1,function(t){a("Ye7u")},"data-v-1b799cec",null);e.default=o.exports},Ye7u:function(t,e){}});