webpackJsonp([6],{"3K6m":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("Dd8w"),s=e.n(i),r=e("TVG1"),n={name:"pie-chart",props:{dataLists:{required:!0,type:Array},title:{required:!0,type:String},color:Array,idName:String},computed:{lists:function(){if(this.dataLists.length>0)return this.props.dataLists}},methods:{drawPie:function(){var t=this.dataLists,a=t.map(function(t){return t.name}),e=this.idName,i=echarts.init(document.getElementById(e)),s={title:{text:this.title,x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:a},series:[{name:"访问来源",type:"pie",radius:"55%",center:["50%","60%"],data:t,color:this.color,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};i.setOption(s,!0)}},mounted:function(){var t=this,a=setInterval(function(){t.dataLists&&t.dataLists.length>0&&(t.drawPie(),clearInterval(a))},1e3)},watch:{dataLists:function(){this.drawPie()}}},o={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{ref:"chart"})},staticRenderFns:[]};var l=e("VU/8")(n,o,!1,function(t){e("FkcU")},"data-v-07a20dad",null).exports,d={name:"line-chart",props:{dataLists:{required:!0,type:Array},title:{required:!0,type:String},color:Array,idName:String,toolName:String},methods:{drawLine:function(){var t=this.dataLists,a=this.idName,e=t.map(function(t){return t.name}),i=t.map(function(t){return t.value}),s=echarts.init(document.getElementById(a)),r={title:{text:this.title,x:"center"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:e},yAxis:{type:"value"},series:[{name:this.toolName,data:i,type:"line",symbol:"triangle",symbolSize:20,lineStyle:{normal:{color:"#2d8cf0",width:4,type:"dashed"}},itemStyle:{normal:{borderWidth:3,borderColor:"#2d8cf0",color:"#fff"}}}]};s.setOption(r,!0)}},mounted:function(){var t=this,a=setInterval(function(){t.dataLists&&t.dataLists.length>0&&(clearInterval(a),t.drawLine())},1e3)},watch:{dataLists:function(){this.drawLine()}}},c={render:function(){var t=this.$createElement;return(this._self._c||t)("div")},staticRenderFns:[]};var m=e("VU/8")(d,c,!1,function(t){e("IIwr")},"data-v-0a600c6a",null).exports,h={name:"bar-chart",props:{dataLists:{required:!0,type:Array},title:{required:!0,type:String},color:Array,idName:String,toolName:String},methods:{drawBar:function(){var t=this.dataLists,a=this.idName,e=t.map(function(t){return t.name}),i=t.map(function(t){return t.value}),s=echarts.init(document.getElementById(a)),r={title:{text:this.title,x:"center"},color:["#3398DB"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},xAxis:{type:"category",data:e},yAxis:{type:"value"},series:[{name:this.toolName,data:i,barWidth:"60%",type:"bar"}]};s.setOption(r,!0)}},mounted:function(){var t=this,a=setInterval(function(){t.dataLists&&t.dataLists.length>0&&(clearInterval(a),t.drawBar())},1e3)},watch:{dataLists:function(){this.drawBar()}}},u={render:function(){var t=this.$createElement;return(this._self._c||t)("div")},staticRenderFns:[]};var v={name:"statistical-chart",components:{pie:l,lineChart:m,bar:e("VU/8")(h,u,!1,function(t){e("HiQx")},"data-v-6e1d6426",null).exports},data:function(){return{stationLists:[],filterForm:{dateRange:[],stationId:""},visited:{rate:0,dataLists:[]},totalOrder:{totalNum:0,detailList:[]},abnormal:{exceptionRate:0,dataLists:[]},timeCoast:{avgAcceptTime:0,dataLists:[]},weekFlow:{totalEarning:0,dataLists:[]},weekTrend:{lastIncrementNum:0,dataLists:[]},hotStation:{bestHotStationName:"",dataLists:[]}}},methods:{dateRangeChange:function(t){this.filterForm.startDate=t[0],this.filterForm.endDate=t[1]},searchDate:function(){var t=s()({},this.filterForm);delete t.dateRange,this.init(t)},getVisited:function(t){var a=this,e={};t&&(e=s()({},t)),e=r.a.formatterParams(t),this.$http.post("/report/return/visit?"+e).then(function(t){if(0===t.data.code){var e=t.data.data,i=t.data.data.finishRate,s=[{name:"已回访",value:e.hasVisitedNum},{name:"未回访",value:e.waitVisitNum}];a.visited={rate:i,dataLists:s}}else console.log("回访率接口："+t.data.msg)})},getTotalOrder:function(t){var a=this,e={};t&&(e=s()({},t)),e=r.a.formatterParams(t),this.$http.post("/report/repair/category?"+e).then(function(t){if(0===t.data.code){var e=t.data.data;a.totalOrder=e}else console.log("报修订单总数："+t.data.msg)})},getAbnormal:function(t){var a=this,e={};t&&(e=s()({},t)),e=r.a.formatterParams(t),this.$http.post("/report/exception?"+e).then(function(t){if(0===t.data.code){var e=t.data.data;a.abnormal={exceptionRate:e.exceptionRate,dataLists:[{name:"正常工单",value:e.totalNum-e.exceptionNum},{name:"异常工单",value:e.exceptionNum}]}}else console.log("异常工单获取："+t.data.msg)})},getWeekFlow:function(t){var a=this,e={};t&&(e=s()({},t)),e=r.a.formatterParams(t),this.$http.post("/report/7days/Earning?"+e).then(function(t){if(0===t.data.code){var e=t.data.data;a.weekFlow={totalEarning:e.totalEarning,dataLists:e.detailList}}else console.log("异常工单获取："+t.data.msg)})},getTimeCoast:function(t){var a=this,e={};t&&(e=s()({},t)),e=r.a.formatterParams(t),this.$http.post("/report/accept/time?"+e).then(function(t){if(0===t.data.code){var e=t.data.data;e||(e={avgAcceptTime:0,minAcceptTime:0,maxAcceptTime:0}),a.timeCoast={avgAcceptTime:e.avgAcceptTime,dataLists:[{name:"最长",value:e.maxAcceptTime},{name:"最短",value:e.minAcceptTime},{name:"平均",value:e.avgAcceptTime}]}}else console.log("异常工单获取："+t.data.msg)})},getWeekTrend:function(t){var a=this,e={};t&&(e=s()({},t)),e=r.a.formatterParams(t),this.$http.post("/report/7days/increment?"+e).then(function(t){if(0===t.data.code){var e=t.data.data;a.weekTrend={lastIncrementNum:e.lastIncrementNum,dataLists:e.detailList}}})},getHotStation:function(t){var a=this,e={};t&&(e=s()({},t)),e=r.a.formatterParams(t),this.$http.post("/report/hot/station?"+e).then(function(t){if(0===t.data.code){var e=t.data.data;a.hotStation={bestHotStationName:e.bestHotStationName,dataLists:e.detailList}}})},init:function(t){this.getVisited(t),this.getTotalOrder(t),this.getAbnormal(t),this.getWeekTrend(t),this.getWeekFlow(t),this.getTimeCoast(t),this.getHotStation(t)}},mounted:function(){var t=this,a=new Date,e=a.getMonth()+1,i=a.getFullYear(),s=a.getDate();this.filterForm.dateRange=[i+"-"+e+"-1",i+"-"+e+"-"+s],r.a.getStationLists(function(a){t.stationLists=a}),this.init()}},p={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("Card",{staticClass:"mb-15"},[e("Form",{attrs:{model:t.filterForm,inline:""}},[e("FormItem",{staticStyle:{"margin-bottom":"0"}},[e("DatePicker",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择时间范围",type:"daterange"},on:{"on-change":t.dateRangeChange},model:{value:t.filterForm.dateRange,callback:function(a){t.$set(t.filterForm,"dateRange",a)},expression:"filterForm.dateRange"}})],1),t._v(" "),e("FormItem",{staticStyle:{"margin-bottom":"0"}},[e("Select",{staticStyle:{width:"150px"},attrs:{placeholder:"选择服务网点"},model:{value:t.filterForm.stationId,callback:function(a){t.$set(t.filterForm,"stationId",a)},expression:"filterForm.stationId"}},t._l(t.stationLists,function(a){return e("Option",{key:a.id,attrs:{value:a.id}},[t._v(t._s(a.name))])}))],1),t._v(" "),e("Button",{staticClass:"lang-btn",attrs:{type:"primary"},on:{click:t.searchDate}},[t._v("搜索")])],1)],1),t._v(" "),e("Row",{staticClass:"mb-15",attrs:{gutter:15}},[e("Col",{attrs:{lg:12,sm:24}},[e("Card",[e("p",{attrs:{slot:"title"},slot:"title"},[t._v("订单总数："+t._s(t.totalOrder.totalNum))]),t._v(" "),e("div",{staticClass:"chart-container",attrs:{id:"chartTotal"}}),t._v(" "),e("pie",{attrs:{"data-lists":t.totalOrder.detailList,title:"各类报修工单占比",idName:"chartTotal"}})],1)],1),t._v(" "),e("Col",{attrs:{lg:12,sm:24}},[e("Card",[e("p",{attrs:{slot:"title"},slot:"title"},[t._v("订单回访率:（"+t._s(t.visited.rate+"%")+"）")]),t._v(" "),e("div",{staticClass:"chart-container",attrs:{id:"chartRate"}}),t._v(" "),e("pie",{attrs:{"data-lists":t.visited.dataLists,title:"订单回访率",color:["#2d8cf0","#ff9900"],idName:"chartRate"}})],1)],1)],1),t._v(" "),e("Row",{staticClass:"mb-15",attrs:{gutter:15}},[e("Col",{attrs:{lg:12,sm:24}},[e("Card",[e("p",{attrs:{slot:"title"},slot:"title"},[t._v("订单平均接单时长："+t._s(t.timeCoast.avgAcceptTime+"min"))]),t._v(" "),e("div",{staticClass:"chart-container",attrs:{id:"timeCoastChart"}}),t._v(" "),e("bar",{attrs:{"data-lists":t.timeCoast.dataLists,title:"订单平均接单时长",idName:"timeCoastChart",toolName:"接单时长"}})],1)],1),t._v(" "),e("Col",{attrs:{lg:12,sm:24}},[e("Card",[e("p",{attrs:{slot:"title"},slot:"title"},[t._v("异常工单占比："+t._s((100*t.abnormal.exceptionRate).toFixed(2)+"%"))]),t._v(" "),e("div",{staticClass:"chart-container",attrs:{id:"abnormalChart"}}),t._v(" "),e("pie",{attrs:{"data-lists":t.abnormal.dataLists,title:"异常工单占比",color:["#2db7f5","#19be6b"],idName:"abnormalChart"}})],1)],1)],1),t._v(" "),e("Row",{staticClass:"mb-15",attrs:{gutter:15}},[e("Col",{attrs:{lg:12,sm:24}},[e("Card",[e("p",{attrs:{slot:"title"},slot:"title"},[t._v("近7日订单流水："+t._s(t.weekFlow.totalEarning))]),t._v(" "),e("div",{staticClass:"chart-container",attrs:{id:"weekFlowChart"}}),t._v(" "),e("line-chart",{attrs:{"data-lists":t.weekFlow.dataLists,title:"近7日订单流水",idName:"weekFlowChart",toolName:"订单金额"}})],1)],1),t._v(" "),e("Col",{attrs:{lg:12,sm:24}},[e("Card",[e("p",{attrs:{slot:"title"},slot:"title"},[t._v("最近增长订单："+t._s(t.weekTrend.lastIncrementNum))]),t._v(" "),e("div",{staticClass:"chart-container",attrs:{id:"weekTrendChart"}}),t._v(" "),e("line-chart",{attrs:{"data-lists":t.weekTrend.dataLists,title:"近7日订单走势",idName:"weekTrendChart",toolName:"订单数量"}})],1)],1)],1),t._v(" "),e("Row",{staticClass:"mb-15",attrs:{gutter:15}},[e("Col",{attrs:{lg:12,sm:24}},[e("Card",[e("p",{attrs:{slot:"title"},slot:"title"},[t._v("服务网点热点-(最热网点："+t._s(t.hotStation.bestHotStationName)+")")]),t._v(" "),e("div",{staticClass:"chart-container",attrs:{id:"hotStationChart"}}),t._v(" "),e("bar",{attrs:{"data-lists":t.hotStation.dataLists,title:"服务网点热点",idName:"hotStationChart",toolName:"工单量"}})],1)],1)],1)],1)},staticRenderFns:[]};var f=e("VU/8")(v,p,!1,function(t){e("niwZ")},"data-v-542bccba",null);a.default=f.exports},FkcU:function(t,a){},HiQx:function(t,a){},IIwr:function(t,a){},niwZ:function(t,a){}});