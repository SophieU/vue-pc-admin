{"version":3,"sources":["webpack:///src/pages/finance/finance-view.vue","webpack:///./src/pages/finance/finance-view.vue?cc04","webpack:///./src/pages/finance/finance-view.vue"],"names":["finance_view","name","data","_this2","this","viewType","filter","repairColumns","title","key","align","detailColumn","width","minWidth","fixed","render","h","params","_this","props","type","on","click","id","row","$router","push","query","repairLists","stationLists","detailLists","earningCount","categoryEarningCountList","detailPageTotal","detailPageSize","detailPageNo","filterForm","repairCategoryId","serverName","stationId","dateRange","methods","getOrderLists","_this3","param","timeType","timeScope","extends_default","startDate","endDate","paramQuery","util","formatterParams","$http","post","then","res","code","list","totalCount","pageSize","getOrderTotal","_this4","console","log","msg","clearFilter","$refs","resetFields","sureFilter","pageChange","val","pageNo","pageSizeChange","filterDateChange","exportExcel","length","responseType","downloadExcel","mounted","_this5","getRepairType","getStationLists","watch","newVal","finance_finance_view","_vm","_h","$createElement","_c","_self","staticClass","attrs","$event","_v","_s","orderNum","orderAmount","employeeCommission","platformCommission","serviceEarning","columns","slot","total","show-sizer","show-elevator","on-change","on-page-size-change","model","value","callback","$$v","expression","ref","label-position","label","prop","$set","_l","item","staticStyle","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/26.b6848bf2484e96968639.js","sourcesContent":["<template>\n  <div>\n    <Card class=\"mb-15\">\n      <div class=\"clearfix mb-15\">\n        <div class=\"pull-left\">\n          <Button @click=\"viewType='month'\" :type=\"viewType==='month'?'primary':'default'\">本月</Button>\n          <Button @click=\"viewType='three'\" :type=\"viewType==='three'?'primary':'default'\">前三月</Button>\n          <Button @click=\"filter=true\">筛选</Button>\n        </div>\n        <div class=\"pull-right\">\n          <Button @click=\"exportExcel\" type=\"primary\">excel导出</Button>\n        </div>\n      </div>\n      <div>\n        <div class=\"table-wrapper mb-15\">\n          <table class=\"native-table\">\n            <thead>\n            <tr>\n              <th>项目名称</th>\n              <th>已付工单总数</th>\n              <th>已付工单收入</th>\n              <th>员工结算</th>\n              <th>平台佣金</th>\n              <th>服务收益</th>\n            </tr>\n            </thead>\n            <tbody>\n            <tr>\n              <td>{{earningCount.name}}</td>\n              <td>{{earningCount.orderNum}}</td>\n              <td>{{earningCount.orderAmount}}</td>\n              <td>{{earningCount.employeeCommission}}</td>\n              <td>{{earningCount.platformCommission}}</td>\n              <td>{{earningCount.serviceEarning}}</td>\n            </tr>\n            </tbody>\n          </table>\n        </div>\n        <div class=\"table-wrapper mb-15\">\n          <Table :columns=\"repairColumns\" :data=\"categoryEarningCountList\"></Table>\n        </div>\n\n      </div>\n\n    </Card>\n\n    <Card>\n      <p slot=\"title\">明细</p>\n      <div class=\"table-wrapper\">\n        <Table :columns=\"detailColumn\" :data=\"detailLists\"></Table>\n        <div class=\"pagination\">\n          <Page :total=\"detailPageTotal\" show-sizer show-elevator\n            @on-change=\"pageChange\"\n                @on-page-size-change=\"pageSizeChange\"\n          ></Page>\n        </div>\n      </div>\n    </Card>\n    <!--筛选-->\n    <Drawer title=\"工单筛选\" v-model=\"filter\" width=\"450\">\n      <div class=\"clearfix mb-15\">\n        <div class=\"pull-left\">\n          <Button @click=\"clearFilter('filterForm')\">清空筛选条件</Button>\n        </div>\n        <div class=\"pull-right\">\n          <Button @click=\"sureFilter\" type=\"primary\">确定</Button>\n        </div>\n      </div>\n      <Form ref=\"filterForm\" :model=\"filterForm\" label-position=\"top\">\n        <FormItem label=\"报修类型\" prop=\"repairCategoryId\">\n          <Select v-model=\"filterForm.repairCategoryId\">\n            <Option v-for=\"item in repairLists\" :key=\"item.id\" :value=\"item.id\">{{item.name}}</Option>\n          </Select>\n        </FormItem>\n        <FormItem label=\"服务人员\" prop=\"serverName\">\n          <Input v-model=\"filterForm.serverName\"/>\n        </FormItem>\n        <FormItem label=\"服务网点\" prop=\"stationId\">\n          <Select v-model=\"filterForm.stationId\">\n            <Option v-for=\"item in stationLists\" :key=\"item.id\" :value=\"item.id\">{{item.name}}</Option>\n          </Select>\n        </FormItem>\n        <FormItem label=\"付款时间\"  prop=\"dateRange\">\n          <DatePicker @on-change=\"filterDateChange\" v-model=\"filterForm.dateRange\" type=\"daterange\" style=\"width:100%;\"></DatePicker>\n        </FormItem>\n      </Form>\n    </Drawer>\n  </div>\n\n</template>\n\n<script>\n  import util from '../../libs/util'\n    export default {\n        name: \"finance-view\",\n      data(){\n          return{\n            viewType:'month', //概况时间：本月-month,前三月-three\n            filter:false,\n            repairColumns:[\n              {title:'报修类型',key:'name',align:'center'},\n              {title:'已付工单总数',key:'orderNum',align:'center'},\n              {title:'已付工单收入',key:'orderAmount',align:'center'},\n              {title:'员工结算',key:'employeeCommission',align:'center'},\n              {title:'平台佣金',key:'platformCommission',align:'center'},\n              {title:'服务收益',key:'serviceEarning',align:'center'},\n            ],\n            detailColumn:[\n              {title:'创建日期',key:'createTime',align:'center',width:140},\n              {title:'付款时间',key:'payTime',align:'center',width:140},\n              {title:'工单单号',key:'orderSn',align:'center',minWidth:160},\n              {title:'支付方式',key:'payType',align:'center',width:100},\n              {title:'交易号',key:'paySn',align:'center',width:140},\n              {title:'报修类型',key:'repairCategoryName',align:'center',width:100},\n              {title:'服务网点',key:'stationName',align:'center',width:100},\n              {title:'工单状态',key:'orderState',align:'center',width:100},\n              {title:'工单金额',key:'orderAmount',align:'center',width:100},\n              {title:'师傅姓名',key:'serverName',align:'center',width:100},\n              {title:'师傅提成',key:'employeeCommission',align:'center',width:100},\n              {title:'平台佣金比',key:'platformCommissionRate',align:'center',width:100},\n              {title:'平台佣金',key:'platformCommission',align:'center',width:100},\n              {title:'操作',fixed:'right',width:100,align:'center',render:(h,params)=>{\n                 let _this = this;\n                 return h('Button',{\n                   props:{\n                     type:'text'\n                   },\n                   on:{\n                     click(){\n                       let id = params.row.id;\n                       _this.$router.push({name:'orderDetail',query:{id:id}});\n                     }\n                   }\n                 },'查看订单')\n                }},\n            ],\n            repairLists:[], //报修下拉\n            stationLists:[], //网点下拉\n            detailLists:[],\n            earningCount:{}, //总统计信息\n            categoryEarningCountList:[], //报修分类统计信息\n            detailPageTotal:0,\n            detailPageSize:10,\n            detailPageNo:1,\n            filterForm:{\n              repairCategoryId:'',\n              serverName:'',\n              stationId:'',\n              dateRange:[],\n            }\n          }\n      },\n      methods:{\n          getOrderLists(filter){\n            let query=`pageNo=${this.detailPageNo}&pageSize=${this.detailPageSize}`;\n            let param = {\n              timeType:1,\n            };\n            if(this.viewType==='month'){\n              param.timeScope=1\n            }else if(this.viewType==='three'){\n              param.timeScope=2\n            }\n            if(filter){\n              param={...filter};\n              if(filter.startDate&&filter.endDate){\n                param.timeType=2;\n                param.timeScope='';\n              }\n            }\n            let paramQuery = util.formatterParams(param);\n\n            this.$http.post(`/order/earning/list?${query}&${paramQuery}`).then(res=>{\n              if(res.data.code===0){\n                let data = res.data.data;\n                this.detailLists=data.list;\n                this.detailPageTotal = data.totalCount;\n                this.detailPageSize=data.pageSize;\n                this.filter=false;\n\n              }\n            })\n          },\n        getOrderTotal(filter){\n          let param = {\n            timeType:1,\n          };\n          if(this.viewType==='month'){\n            param.timeScope=1\n          }else if(this.viewType==='three'){\n            param.timeScope=2\n          }\n          if(filter){\n            param={...filter};\n            if(filter.startDate&&filter.endDate){\n              param.timeType=2;\n              delete param.timeScope;\n            }\n          }\n          let query=util.formatterParams(param);\n          this.$http.post(`/order/earning/count?${query}`).then(res=>{\n              if(res.data.code===0){\n                let data = res.data.data;\n                this.earningCount=data.earningCount;\n                this.categoryEarningCountList=data.categoryEarningCountList;\n                this.filter=false;\n                if(filter&&filter.startDate){\n                  this.viewType='';\n                }\n              }else{\n                console.log('财务统计信息失败：'+res.data.msg);\n              }\n          })\n        },\n        clearFilter(name){\n            this.$refs[name].resetFields();\n            this.filter=false;\n            this.getOrderLists();\n            this.getOrderTotal();\n        },\n        sureFilter(){\n            let filterForm ={...this.filterForm};\n            if(filterForm.dateRange){\n              delete filterForm.dateRange;\n            }\n            this.getOrderLists(filterForm);\n            this.getOrderTotal(filterForm);\n        },\n        pageChange(val){\n          this.pageNo=val;\n          this.getOrderLists();\n        },\n        pageSizeChange(val){\n          this.pageSize=val;\n          this.getOrderLists();\n        },\n        //筛选时间范围格式化\n        filterDateChange(val){\n            this.filterForm.startDate=val[0];\n            this.filterForm.endDate=val[1];\n            // this.filterForm.startDate=util.formateTime(val[0],true);\n            // this.filterForm.endDate=util.formateTime(val[1],true);\n        },\n        exportExcel(){\n          let filter = {...this.filterForm};\n          let param = {\n            timeType:1,\n          };\n          if(this.viewType==='month'){\n            param.timeScope=1\n          }else if(this.viewType==='three'){\n            param.timeScope=2\n          }\n          for(let key in filter){\n            if(filter[key].length>0||filter[key]>0){\n              param[key]=filter[key];\n            }\n            if(param.startDate&&param.endDate){\n              param.timeType=2;\n              delete param.timeScope;\n              delete param.dateRange;\n            }\n          }\n          let query=util.formatterParams(param);\n\n            this.$http.post(`/order/earning/export?${query}`,null,{responseType:'blob'})\n              .then(res=>{\n                util.downloadExcel(res);\n              })\n        }\n      },\n      mounted(){\n        this.getOrderLists();\n        this.getOrderTotal();\n        //报修下拉\n        util.getRepairType(data=>{\n          this.repairLists=data;\n        });\n        //网点下拉\n        util.getStationLists(data=>{\n          this.stationLists=data;\n        })\n      },\n      watch:{\n        viewType(newVal){\n            if(newVal){\n              this.getOrderLists();\n              this.getOrderTotal();\n            }\n          }\n      }\n    }\n</script>\n\n<style scoped>\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/pages/finance/finance-view.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('Card',{staticClass:\"mb-15\"},[_c('div',{staticClass:\"clearfix mb-15\"},[_c('div',{staticClass:\"pull-left\"},[_c('Button',{attrs:{\"type\":_vm.viewType==='month'?'primary':'default'},on:{\"click\":function($event){_vm.viewType='month'}}},[_vm._v(\"本月\")]),_vm._v(\" \"),_c('Button',{attrs:{\"type\":_vm.viewType==='three'?'primary':'default'},on:{\"click\":function($event){_vm.viewType='three'}}},[_vm._v(\"前三月\")]),_vm._v(\" \"),_c('Button',{on:{\"click\":function($event){_vm.filter=true}}},[_vm._v(\"筛选\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"pull-right\"},[_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.exportExcel}},[_vm._v(\"excel导出\")])],1)]),_vm._v(\" \"),_c('div',[_c('div',{staticClass:\"table-wrapper mb-15\"},[_c('table',{staticClass:\"native-table\"},[_c('thead',[_c('tr',[_c('th',[_vm._v(\"项目名称\")]),_vm._v(\" \"),_c('th',[_vm._v(\"已付工单总数\")]),_vm._v(\" \"),_c('th',[_vm._v(\"已付工单收入\")]),_vm._v(\" \"),_c('th',[_vm._v(\"员工结算\")]),_vm._v(\" \"),_c('th',[_vm._v(\"平台佣金\")]),_vm._v(\" \"),_c('th',[_vm._v(\"服务收益\")])])]),_vm._v(\" \"),_c('tbody',[_c('tr',[_c('td',[_vm._v(_vm._s(_vm.earningCount.name))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(_vm.earningCount.orderNum))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(_vm.earningCount.orderAmount))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(_vm.earningCount.employeeCommission))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(_vm.earningCount.platformCommission))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(_vm.earningCount.serviceEarning))])])])])]),_vm._v(\" \"),_c('div',{staticClass:\"table-wrapper mb-15\"},[_c('Table',{attrs:{\"columns\":_vm.repairColumns,\"data\":_vm.categoryEarningCountList}})],1)])]),_vm._v(\" \"),_c('Card',[_c('p',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\"明细\")]),_vm._v(\" \"),_c('div',{staticClass:\"table-wrapper\"},[_c('Table',{attrs:{\"columns\":_vm.detailColumn,\"data\":_vm.detailLists}}),_vm._v(\" \"),_c('div',{staticClass:\"pagination\"},[_c('Page',{attrs:{\"total\":_vm.detailPageTotal,\"show-sizer\":\"\",\"show-elevator\":\"\"},on:{\"on-change\":_vm.pageChange,\"on-page-size-change\":_vm.pageSizeChange}})],1)],1)]),_vm._v(\" \"),_c('Drawer',{attrs:{\"title\":\"工单筛选\",\"width\":\"450\"},model:{value:(_vm.filter),callback:function ($$v) {_vm.filter=$$v},expression:\"filter\"}},[_c('div',{staticClass:\"clearfix mb-15\"},[_c('div',{staticClass:\"pull-left\"},[_c('Button',{on:{\"click\":function($event){_vm.clearFilter('filterForm')}}},[_vm._v(\"清空筛选条件\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"pull-right\"},[_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.sureFilter}},[_vm._v(\"确定\")])],1)]),_vm._v(\" \"),_c('Form',{ref:\"filterForm\",attrs:{\"model\":_vm.filterForm,\"label-position\":\"top\"}},[_c('FormItem',{attrs:{\"label\":\"报修类型\",\"prop\":\"repairCategoryId\"}},[_c('Select',{model:{value:(_vm.filterForm.repairCategoryId),callback:function ($$v) {_vm.$set(_vm.filterForm, \"repairCategoryId\", $$v)},expression:\"filterForm.repairCategoryId\"}},_vm._l((_vm.repairLists),function(item){return _c('Option',{key:item.id,attrs:{\"value\":item.id}},[_vm._v(_vm._s(item.name))])}))],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"服务人员\",\"prop\":\"serverName\"}},[_c('Input',{model:{value:(_vm.filterForm.serverName),callback:function ($$v) {_vm.$set(_vm.filterForm, \"serverName\", $$v)},expression:\"filterForm.serverName\"}})],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"服务网点\",\"prop\":\"stationId\"}},[_c('Select',{model:{value:(_vm.filterForm.stationId),callback:function ($$v) {_vm.$set(_vm.filterForm, \"stationId\", $$v)},expression:\"filterForm.stationId\"}},_vm._l((_vm.stationLists),function(item){return _c('Option',{key:item.id,attrs:{\"value\":item.id}},[_vm._v(_vm._s(item.name))])}))],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"付款时间\",\"prop\":\"dateRange\"}},[_c('DatePicker',{staticStyle:{\"width\":\"100%\"},attrs:{\"type\":\"daterange\"},on:{\"on-change\":_vm.filterDateChange},model:{value:(_vm.filterForm.dateRange),callback:function ($$v) {_vm.$set(_vm.filterForm, \"dateRange\", $$v)},expression:\"filterForm.dateRange\"}})],1)],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-6afd8195\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/finance/finance-view.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-6afd8195\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./finance-view.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./finance-view.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./finance-view.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6afd8195\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./finance-view.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-6afd8195\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/finance/finance-view.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}