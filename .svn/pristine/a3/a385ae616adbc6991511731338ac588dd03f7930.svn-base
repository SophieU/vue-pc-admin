{"version":3,"sources":["webpack:///src/pages/source/new-in.vue","webpack:///./src/pages/source/new-in.vue?36c0","webpack:///./src/pages/source/new-in.vue"],"names":["new_in","name","data","test","showModal","lists","organLists","formIn","sn","inputType","detailList","formInRules","required","message","trigger","repairType","id","searchForm","categoryId","searchKey","pageSize","pageNo","materialTotal","materialLists","materialCheck","materialCheckTemp","materialCheckedlists","methods","sureIn","_this","this","form","detailValid","map","item","notValidType","notValid","price","push","num","amount","$refs","validate","valid","materialId","$http","post","extends_default","then","res","code","$Message","success","$router","error","msg","getRepairType","_this2","get","concat","console","log","searchMaterial","_this3","param","util","formatterParams","checkedLists","list","index","forEach","checkItem","checked","hasChecked","compareChoosed","totalCount","materialPageChange","val","pageSIze","sureMaterial","checkLists","checkTemp","checkChange","_this4","split","parseInt","ind","splice","modalVisible","visible","inputChange","parseFloat","toFixed","inputNumInt","event","key","preventDefault","deleteMaterial","hasCheck","check","disabled","mounted","source_new_in","render","_vm","_h","$createElement","_c","_self","staticStyle","padding-bottom","staticClass","on","click","$event","back","_v","attrs","type","ref","margin-right","model","rules","label-width","label","prop","value","callback","$$v","$set","expression","_l","material","_s","spec","unit","width","min","placeholder","precision","on-change","indexOf","_e","on-keydown","readonly","title","on-visible-change","inline","repair","true-value","false-value","size","total","slot","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/14.288a6bd3dd6108960114.js","sourcesContent":["<style scoped lang=\"scss\">\n  @import \"./source.scss\";\n</style>\n<template>\n    <Card style=\"padding-bottom: 30px;\">\n      <div class=\"mb-15 clearfix\">\n        <div class=\"pull-left\">\n          <Button @click=\"$router.back()\" >返回上一页</Button>\n        </div>\n        <div class=\"pull-right\">\n          <Button @click=\"sureIn\" type=\"primary\">确认入库</Button>\n        </div>\n      </div>\n      <Form style=\"margin-right: 100px;\" ref=\"formIn\" :model=\"formIn\" :rules=\"formInRules\" :label-width=\"100\">\n        <!--<FormItem label=\"组织名称\">-->\n          <!--<Select v-model=\"formIn.organ\" class=\"w300\">-->\n            <!--<Option v-for=\"organ in organLists\" :key=\"organ.id\" :value=\"organ.id+'-'+organ.type\">{{organ.name}}</Option>-->\n          <!--</Select>-->\n        <!--</FormItem>-->\n        <FormItem label=\"入库类型\" prop=\"inputType\">\n          <Select v-model=\"formIn.inputType\" class=\"w300\">\n            <Option value=\"PURCHASE\">采购</Option>\n          </Select>\n        </FormItem>\n        <FormItem label=\"原始单号\" prop=\"sn\">\n          <Input v-model=\"formIn.sn\" class=\"w400\"/>\n        </FormItem>\n        <FormItem label=\"辅材\">\n          <Button @click=\"showModal=true\">添加辅材</Button>\n        </FormItem>\n      </Form>\n      <div class=\"table-wrapper\">\n          <table class=\"native-table\">\n            <thead>\n            <tr>\n              <th>辅材名称</th>\n              <th>型号</th>\n              <th>单位 </th>\n              <th>单价 <span class=\"text-red\">*</span></th>\n              <th>数量 <span class=\"text-red\">*</span></th>\n              <th>入库成本 <span class=\"text-red\">*</span></th>\n              <th>操作</th>\n            </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"(material,index) in materialCheckedlists\" :key=\"material.id\">\n                <td>{{material.name}}</td>\n                <td>{{material.spec}}</td>\n                <td>{{material.unit}}</td>\n                <td  style=\"width:200px;\">\n                    <InputNumber style=\"width:80%;\" v-model=\"material.price\" :min=\"1\" placeholder=\"请输入单价\"\n                                 :precision=\"2\"\n                                 @on-change=\"inputChange(index)\"\n                    ></InputNumber>\n                  <p v-if=\"material.notValid&&material.notValidType.indexOf('price')>-1\" class=\"text-red\">请输入单价</p>\n                </td>\n                <td style=\"width:200px;\">\n                  <Input placeholder=\"请输入数量\" v-model=\"material.num\" style=\"width:80%;\" @on-keydown=\"inputNumInt($event)\" @on-change=\"inputChange(index)\"/>\n                  <p  v-if=\"material.notValid&&material.notValidType.indexOf('num')>-1\" class=\"text-red\">请输入数量</p>\n                </td>\n                <td style=\"width:200px;\">\n                    <InputNumber  :precision=\"2\" readonly style=\"width:80%;\" v-model=\"material.amount\"  :min=\"1\" placeholder=\"请输入入库成本\"></InputNumber>\n                  <p  v-if=\"material.notValid&&material.notValidType.indexOf('amount')>-1\" class=\"text-red\">请输入成本价</p>\n                </td>\n                <td>\n                  <Button type=\"text\" class=\"text-red\" @click=\"deleteMaterial(index)\">删除</Button>\n                </td>\n              </tr>\n\n            </tbody>\n          </table>\n      </div>\n      <!--辅材弹窗-->\n      <Modal title=\"选择辅材\" v-model=\"showModal\" width=\"650\" @on-visible-change=\"modalVisible\">\n        <div>\n          <div class=\"mb-15\">\n            <Form ref=\"searchForm\" :model=\"searchForm\" inline :label-width=\"70\">\n              <FormItem label=\"辅材类别\">\n                <Select style=\"width:160px ;\" v-model=\"searchForm.categoryId\">\n                  <Option v-for=\"repair in repairType\" :value=\"repair.id\" :key=\"repair.id\">{{repair.name}}</Option>\n                </Select>\n              </FormItem>\n              <FormItem label=\"关键字\">\n                <!--bug 3109 保留：或型号-->\n                <Input v-model=\"searchForm.searchKey\" placeholder=\"请输入辅材名称\"/>\n              </FormItem>\n              <Button @click=\"searchMaterial\" type=\"primary\">搜索</Button>\n            </Form>\n          </div>\n          <div class=\"table-wrapper\">\n              <table class=\"native-table\">\n                <thead>\n                <tr>\n                  <th>辅材名称</th>\n                  <th>型号</th>\n                  <th>单位</th>\n                  <th>操作</th>\n                </tr>\n                </thead>\n                <tbody>\n                <tr v-for=\"(material,index) in materialLists\" :key=\"material.id\">\n                  <td>{{material.name}}</td>\n                  <td>{{material.spec}}</td>\n                  <td>{{material.unit}}</td>\n                  <td>\n                    <!--<Button type=\"text\" class=\"text-blue\">选择</Button>-->\n                    <Checkbox :disabled=\"material.disabled\" v-model=\"material.checked\" @on-change=\"checkChange\" :true-value=\"1+'-'+index\" :false-value=\"0+'-'+index\">选择</Checkbox>\n                  </td>\n                </tr>\n                </tbody>\n              </table>\n            <div class=\"pagination\">\n              <Page @on-change=\"materialPageChange\" size=\"small\" :total=\"materialTotal\" ></Page>\n            </div>\n          </div>\n        </div>\n        <div slot=\"footer\">\n          <Button @click=\"showModal=false\">关闭</Button>\n          <Button type=\"primary\" @click=\"sureMaterial\">确认</Button>\n        </div>\n      </Modal>\n\n    </Card>\n</template>\n\n<script>\n  import util from '../../libs/util';\n    export default {\n        name: \"new-out\",\n      data(){\n          return {\n            test:true,\n            showModal:false,\n            lists:[ ],\n            organLists:[], //组织列表\n            formIn:{\n              // organ:'',\n              sn:'',\n              inputType:'',\n              detailList:'',\n            },\n            formInRules:{\n              inputType:[{required:true,message:'请选择入库类型',trigger:'change'}],\n            },\n            repairType:[{name:'全部',id:'0'}], //报修分类列表\n            searchForm:{\n              categoryId:'',\n              searchKey:'',\n              pageSize:5,\n              pageNo:1,\n            },\n            materialTotal:0, //辅材搜索，列表总条数\n            materialLists:[], //辅材列表\n            materialCheck:[], //弹窗已选辅材\n            materialCheckTemp:[], //弹窗已选辅材\n            materialCheckedlists:[],//界面已选辅材\n\n\n          }\n      },\n      methods:{\n        sureIn(){\n            let form = this.formIn;\n            let detailList = this.materialCheckedlists;\n            let detailValid = true;\n            this.materialCheckedlists=detailList.map(item=>{\n              item.notValidType=[];\n              item.notValid=false;\n              if(!item.price){\n                detailValid=false;\n                item.notValid=true;\n                item.notValidType.push('price');\n              }\n              if(!item.num){\n                detailValid=false;\n                item.notValid=true;\n                item.notValidType.push('num');\n              }\n              if(!item.amount){\n                detailValid=false;\n                item.notValid=true;\n                item.notValidType.push('amount');\n              }\n              return item;\n            });\n            if(!detailValid) return;\n            this.$refs['formIn'].validate(valid=>{\n              if(valid){\n                form.detailList=detailList.map(item=>{\n                  let data = {\n                    materialId:item.id,\n                    price:item.price,\n                    amount:item.amount,\n                    num:item.num\n                  };\n                  return data;\n                });\n                this.$http.post(`/repair/material/input/order/add`,{\n                  ...form\n                }).then(res=>{\n                  if(res.data.code===0){\n                    this.$Message.success('保存成功');\n                    this.$router.push({name:'import'})\n                  }else{\n                    this.$Message.error(res.data.msg);\n                  }\n                })\n              }\n            })\n\n        },\n        //获取辅材分类\n        getRepairType(){\n            this.$http.get(`/repair/category/list`)\n              .then(res=>{\n                if(res.data.code===0){\n                  this.repairType=this.repairType.concat(res.data.data);\n                }else{\n                  console.log('报修分类获取失败：'+res.data.msg);\n                }\n              })\n        },\n        //搜索辅材\n        searchMaterial(){\n            let searchForm = this.searchForm;\n            if(searchForm.categoryId==='0'){\n              delete searchForm.categoryId;\n            }\n            let param =util.formatterParams(searchForm);\n          this.$http.post(`/repair/material/selectList?${param}`)\n            .then(res=>{\n              if(res.data.code===0){\n                let data = res.data.data;\n                let checkedLists = this.materialCheckTemp;\n                // 用于标记已选辅材\n                /*\n                * materialLists:搜索结果列表\n                * */\n                this.materialLists = data.list.map((item,index)=>{\n                  checkedLists.forEach(checkItem=>{\n                    if(item.id===checkItem.id){\n                      item.checked='1-'+index;\n                    }\n                  });\n                  if(!item.checked){\n                    item.checked='0-'+index;\n                  }\n                  return item;\n                });\n                // 禁用已选项\n                  let hasChecked = this.materialCheck;\n                  let lists = this.materialLists;\n                  this.materialLists=this.compareChoosed(hasChecked,lists);\n\n                  //设置页码\n                  this.materialTotal = data.totalCount\n              }else{\n                console.log('辅材搜索失败：'+res.data.msg)\n              }\n            })\n        },\n        //辅材分页切换\n        materialPageChange(val){\n          this.searchForm.pageSIze=val;\n          this.searchMaterial();\n        },\n        //确定弹窗\n        sureMaterial(){\n            let checkLists = this.materialCheckTemp;\n            this.showModal=false;\n            let checkTemp = checkLists.map(item=>{\n                item.num=null;\n                item.amount=null;\n                if(!item.price){\n                  item.price=null;\n                }else{\n                  item.price*=1;\n                }\n                return item;\n            });\n            this.materialCheckedlists = this.materialCheckedlists.concat(checkTemp);\n\n        },\n        //弹窗选择辅材交互\n        checkChange(val){\n          /**\n           * 辅材选择切换：val构成： boolean-index\n           */\n          let materialLists = this.materialLists;\n          val = val.split('-');\n          let checked = val[0];\n          let index = parseInt(val[1]);\n          if(checked==='1'){\n            this.materialCheckTemp.push(materialLists[index])\n          }else{\n            this.materialCheckTemp.map((item,ind)=>{\n              if(item.id===materialLists[index].id){\n                this.materialCheckTemp.splice(ind,1);\n              }\n            });\n          }\n\n        },\n        //弹窗显示状态变化\n        modalVisible(visible){\n            /*\n            *  materialLists:[], //辅材列表\n            *    materialCheckedlists  //界面已选辅材\n            * */\n            if(!visible){\n                //显示时，比对已选辅材，并设置disabled\n              this.materialCheckTemp=[];\n              this.materialLists=[];\n              this.materialCheck=this.materialCheckedlists;\n              this.searchForm={\n                  categoryId:'',\n                  searchKey:'',\n                  pageSize:5,\n                  pageNo:1,\n              };\n            }else{\n              this.searchMaterial();\n            }\n        },\n        //计算入库成本\n        inputChange(index){\n            this.materialCheckedlists=this.materialCheckedlists.map((item,ind)=>{\n              if(index===ind){\n                if(item.price&&item.num){\n                  item.amount=parseFloat((item.price*item.num).toFixed(2));\n                }else{\n                  item.amount=null;\n                }\n              }\n              return item;\n            });\n        },\n        inputNumInt(event){\n            let key=event.key;\n            if(/\\D/.test(key)){\n              if(key!=='Backspace'){\n                event.preventDefault();\n              }\n            }\n        },\n        //删除已选辅材\n        deleteMaterial(index){\n            this.materialCheckedlists.splice(index,1);\n        },\n        /*用于比对已选辅材*/\n        compareChoosed(hasCheck,lists){\n\n            lists=lists.map(item=>{\n              hasCheck.forEach(check=>{\n                if(item.id===check.id){\n                  item.disabled=true;\n                }\n              });\n              if(!item.disabled){\n                item.disabled=false;\n              }\n              return item;\n            });\n          return lists;\n        }\n      },\n      mounted(){\n          this.getRepairType();\n          this.searchMaterial();\n\n      },\n\n    }\n</script>\n\n\n\n\n\n// WEBPACK FOOTER //\n// src/pages/source/new-in.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Card',{staticStyle:{\"padding-bottom\":\"30px\"}},[_c('div',{staticClass:\"mb-15 clearfix\"},[_c('div',{staticClass:\"pull-left\"},[_c('Button',{on:{\"click\":function($event){_vm.$router.back()}}},[_vm._v(\"返回上一页\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"pull-right\"},[_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.sureIn}},[_vm._v(\"确认入库\")])],1)]),_vm._v(\" \"),_c('Form',{ref:\"formIn\",staticStyle:{\"margin-right\":\"100px\"},attrs:{\"model\":_vm.formIn,\"rules\":_vm.formInRules,\"label-width\":100}},[_c('FormItem',{attrs:{\"label\":\"入库类型\",\"prop\":\"inputType\"}},[_c('Select',{staticClass:\"w300\",model:{value:(_vm.formIn.inputType),callback:function ($$v) {_vm.$set(_vm.formIn, \"inputType\", $$v)},expression:\"formIn.inputType\"}},[_c('Option',{attrs:{\"value\":\"PURCHASE\"}},[_vm._v(\"采购\")])],1)],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"原始单号\",\"prop\":\"sn\"}},[_c('Input',{staticClass:\"w400\",model:{value:(_vm.formIn.sn),callback:function ($$v) {_vm.$set(_vm.formIn, \"sn\", $$v)},expression:\"formIn.sn\"}})],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"辅材\"}},[_c('Button',{on:{\"click\":function($event){_vm.showModal=true}}},[_vm._v(\"添加辅材\")])],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"table-wrapper\"},[_c('table',{staticClass:\"native-table\"},[_c('thead',[_c('tr',[_c('th',[_vm._v(\"辅材名称\")]),_vm._v(\" \"),_c('th',[_vm._v(\"型号\")]),_vm._v(\" \"),_c('th',[_vm._v(\"单位 \")]),_vm._v(\" \"),_c('th',[_vm._v(\"单价 \"),_c('span',{staticClass:\"text-red\"},[_vm._v(\"*\")])]),_vm._v(\" \"),_c('th',[_vm._v(\"数量 \"),_c('span',{staticClass:\"text-red\"},[_vm._v(\"*\")])]),_vm._v(\" \"),_c('th',[_vm._v(\"入库成本 \"),_c('span',{staticClass:\"text-red\"},[_vm._v(\"*\")])]),_vm._v(\" \"),_c('th',[_vm._v(\"操作\")])])]),_vm._v(\" \"),_c('tbody',_vm._l((_vm.materialCheckedlists),function(material,index){return _c('tr',{key:material.id},[_c('td',[_vm._v(_vm._s(material.name))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(material.spec))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(material.unit))]),_vm._v(\" \"),_c('td',{staticStyle:{\"width\":\"200px\"}},[_c('InputNumber',{staticStyle:{\"width\":\"80%\"},attrs:{\"min\":1,\"placeholder\":\"请输入单价\",\"precision\":2},on:{\"on-change\":function($event){_vm.inputChange(index)}},model:{value:(material.price),callback:function ($$v) {_vm.$set(material, \"price\", $$v)},expression:\"material.price\"}}),_vm._v(\" \"),(material.notValid&&material.notValidType.indexOf('price')>-1)?_c('p',{staticClass:\"text-red\"},[_vm._v(\"请输入单价\")]):_vm._e()],1),_vm._v(\" \"),_c('td',{staticStyle:{\"width\":\"200px\"}},[_c('Input',{staticStyle:{\"width\":\"80%\"},attrs:{\"placeholder\":\"请输入数量\"},on:{\"on-keydown\":function($event){_vm.inputNumInt($event)},\"on-change\":function($event){_vm.inputChange(index)}},model:{value:(material.num),callback:function ($$v) {_vm.$set(material, \"num\", $$v)},expression:\"material.num\"}}),_vm._v(\" \"),(material.notValid&&material.notValidType.indexOf('num')>-1)?_c('p',{staticClass:\"text-red\"},[_vm._v(\"请输入数量\")]):_vm._e()],1),_vm._v(\" \"),_c('td',{staticStyle:{\"width\":\"200px\"}},[_c('InputNumber',{staticStyle:{\"width\":\"80%\"},attrs:{\"precision\":2,\"readonly\":\"\",\"min\":1,\"placeholder\":\"请输入入库成本\"},model:{value:(material.amount),callback:function ($$v) {_vm.$set(material, \"amount\", $$v)},expression:\"material.amount\"}}),_vm._v(\" \"),(material.notValid&&material.notValidType.indexOf('amount')>-1)?_c('p',{staticClass:\"text-red\"},[_vm._v(\"请输入成本价\")]):_vm._e()],1),_vm._v(\" \"),_c('td',[_c('Button',{staticClass:\"text-red\",attrs:{\"type\":\"text\"},on:{\"click\":function($event){_vm.deleteMaterial(index)}}},[_vm._v(\"删除\")])],1)])}))])]),_vm._v(\" \"),_c('Modal',{attrs:{\"title\":\"选择辅材\",\"width\":\"650\"},on:{\"on-visible-change\":_vm.modalVisible},model:{value:(_vm.showModal),callback:function ($$v) {_vm.showModal=$$v},expression:\"showModal\"}},[_c('div',[_c('div',{staticClass:\"mb-15\"},[_c('Form',{ref:\"searchForm\",attrs:{\"model\":_vm.searchForm,\"inline\":\"\",\"label-width\":70}},[_c('FormItem',{attrs:{\"label\":\"辅材类别\"}},[_c('Select',{staticStyle:{\"width\":\"160px\"},model:{value:(_vm.searchForm.categoryId),callback:function ($$v) {_vm.$set(_vm.searchForm, \"categoryId\", $$v)},expression:\"searchForm.categoryId\"}},_vm._l((_vm.repairType),function(repair){return _c('Option',{key:repair.id,attrs:{\"value\":repair.id}},[_vm._v(_vm._s(repair.name))])}))],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"关键字\"}},[_c('Input',{attrs:{\"placeholder\":\"请输入辅材名称\"},model:{value:(_vm.searchForm.searchKey),callback:function ($$v) {_vm.$set(_vm.searchForm, \"searchKey\", $$v)},expression:\"searchForm.searchKey\"}})],1),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.searchMaterial}},[_vm._v(\"搜索\")])],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"table-wrapper\"},[_c('table',{staticClass:\"native-table\"},[_c('thead',[_c('tr',[_c('th',[_vm._v(\"辅材名称\")]),_vm._v(\" \"),_c('th',[_vm._v(\"型号\")]),_vm._v(\" \"),_c('th',[_vm._v(\"单位\")]),_vm._v(\" \"),_c('th',[_vm._v(\"操作\")])])]),_vm._v(\" \"),_c('tbody',_vm._l((_vm.materialLists),function(material,index){return _c('tr',{key:material.id},[_c('td',[_vm._v(_vm._s(material.name))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(material.spec))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(material.unit))]),_vm._v(\" \"),_c('td',[_c('Checkbox',{attrs:{\"disabled\":material.disabled,\"true-value\":1+'-'+index,\"false-value\":0+'-'+index},on:{\"on-change\":_vm.checkChange},model:{value:(material.checked),callback:function ($$v) {_vm.$set(material, \"checked\", $$v)},expression:\"material.checked\"}},[_vm._v(\"选择\")])],1)])}))]),_vm._v(\" \"),_c('div',{staticClass:\"pagination\"},[_c('Page',{attrs:{\"size\":\"small\",\"total\":_vm.materialTotal},on:{\"on-change\":_vm.materialPageChange}})],1)])]),_vm._v(\" \"),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('Button',{on:{\"click\":function($event){_vm.showModal=false}}},[_vm._v(\"关闭\")]),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.sureMaterial}},[_vm._v(\"确认\")])],1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-d23b368e\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/source/new-in.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-d23b368e\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./new-in.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./new-in.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./new-in.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-d23b368e\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./new-in.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-d23b368e\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/source/new-in.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}