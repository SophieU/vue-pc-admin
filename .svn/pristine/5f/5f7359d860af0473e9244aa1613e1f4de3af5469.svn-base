{"version":3,"sources":["webpack:///src/pages/source/new-out.vue","webpack:///./src/pages/source/new-out.vue?ca4c","webpack:///./src/pages/source/new-out.vue"],"names":["new_out","name","data","sureAdd","loadingSave","showModal","outputForm","sn","outputType","outputFormRule","required","message","trigger","searchForm","categoryId","searchKey","pageSize","pageNo","repairType","materialCheckedlists","materialTotal","materialLists","materialCheck","materialCheckTemp","methods","deleteMater","ind","this","splice","modalVisible","visible","materialPageChange","val","pageSIze","searchMaterial","sureMaterial","checkLists","checkTemp","map","item","num","amount","concat","_this","param","util","formatterParams","$http","post","then","res","code","checkedLists","list","index","forEach","checkItem","id","checked","hasChecked","lists","compareChoosed","totalCount","console","log","msg","numChange","price","toFixed","getRepairType","_this2","get","checkChange","_this3","split","parseInt","push","hasCheck","check","disabled","sureOut","_this4","form","detailList","detailValid","notValidType","notValid","$refs","validate","valid","materialId","extends_default","$Message","success","$router","error","mounted","source_new_out","render","_vm","_h","$createElement","_c","_self","staticStyle","padding-bottom","staticClass","on","click","$event","back","_v","attrs","loading","type","ref","margin-right","model","rules","label-width","label","prop","value","callback","$$v","$set","expression","_l","material","key","_s","spec","unit","width","step","min","placeholder","on-change","indexOf","_e","title","on-visible-change","inline","repair","true-value","false-value","size","total","slot","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/20.c27bc02a1cad7b0676a1.js","sourcesContent":["<style scoped lang=\"scss\">\n  @import \"./source.scss\";\n</style>\n<template>\n    <Card style=\"padding-bottom:30px;\">\n      <div class=\"clearfix mb-15\">\n        <div class=\"pull-left\">\n          <Button @click=\"$router.back()\">返回上一页</Button>\n        </div>\n        <div class=\"pull-right\">\n          <Button :loading=\"loadingSave\" @click=\"sureOut\" type=\"primary\">确定出库</Button>\n        </div>\n      </div>\n\n      <Form ref=\"outForm\" :model=\"outputForm\" :rules=\"outputFormRule\" :label-width=\"100\" style=\"margin-right:200px;\">\n        <FormItem label=\"出库类型\" prop=\"outputType\">\n          <Select v-model=\"outputForm.outputType\" class=\"w300\">\n            <Option value=\"REFUND\">退货</Option>\n          </Select>\n        </FormItem>\n        <FormItem label=\"原始单号\">\n          <Input v-model=\"outputForm.sn\" class=\"w400\"/>\n        </FormItem>\n        <FormItem label=\"辅材\">\n          <Button @click=\"showModal=true\">添加辅材</Button>\n        </FormItem>\n      </Form>\n      <div class=\"table-wrapper\">\n        <table class=\"native-table\">\n          <thead>\n          <tr>\n            <th>辅材名称</th>\n            <th>型号</th>\n            <th>单位</th>\n            <th>单价</th>\n            <th>数量  <span class=\"text-red\">*</span></th>\n            <th>出库成本</th>\n            <th>操作</th>\n          </tr>\n          </thead>\n          <tbody>\n          <tr v-for=\"(material,index) in materialCheckedlists\" :key=\"index\">\n            <td>{{material.name}}</td>\n            <td>{{material.spec}}</td>\n            <td>{{material.unit}}</td>\n            <td>{{material.price}}</td>\n            <td style=\"width:200px\">\n              <InputNumber @on-change=\"numChange(material.num,index)\" style=\"width:80%;\" v-model=\"material.num\" :step=\"1\" :min=\"1\" placeholder=\"请输入数量\"></InputNumber>\n              <p v-if=\"material.notValid&&material.notValidType.indexOf('num')>-1\" class=\"text-red\">请输入单价</p>\n            </td>\n            <td>{{material.amount}}</td>\n            <td>\n              <Button @click=\"deleteMater(index)\" type=\"text\" class=\"text-red\">删除</Button>\n            </td>\n          </tr>\n          </tbody>\n        </table>\n      </div>\n      <!--辅材弹窗-->\n      <!--辅材弹窗-->\n      <Modal title=\"选择辅材\" v-model=\"showModal\" width=\"650\" @on-visible-change=\"modalVisible\">\n        <div>\n          <div class=\"mb-15\">\n            <Form ref=\"searchForm\" :model=\"searchForm\" inline :label-width=\"70\">\n              <FormItem label=\"辅材类别\">\n                <Select style=\"width:160px ;\" v-model=\"searchForm.categoryId\">\n                  <Option v-for=\"repair in repairType\" :value=\"repair.id\" :key=\"repair.id\">{{repair.name}}</Option>\n                </Select>\n              </FormItem>\n              <FormItem label=\"关键字\">\n                <Input v-model=\"searchForm.searchKey\" placeholder=\"请输入辅材名称或型号\"/>\n              </FormItem>\n              <Button @click=\"searchMaterial\" type=\"primary\">搜索</Button>\n            </Form>\n          </div>\n          <div class=\"table-wrapper\">\n            <table class=\"native-table\">\n              <thead>\n              <tr>\n                <th>辅材名称</th>\n                <th>型号</th>\n                <th>单位</th>\n                <th>操作</th>\n              </tr>\n              </thead>\n              <tbody>\n              <tr v-for=\"(material,index) in materialLists\" :key=\"material.id\">\n                <td>{{material.name}}</td>\n                <td>{{material.spec}}</td>\n                <td>{{material.unit}}</td>\n                <td>\n                  <!--<Button type=\"text\" class=\"text-blue\">选择</Button>-->\n                  <Checkbox :disabled=\"material.disabled\" v-model=\"material.checked\" @on-change=\"checkChange\" :true-value=\"1+'-'+index\" :false-value=\"0+'-'+index\">选择</Checkbox>\n                </td>\n              </tr>\n              </tbody>\n            </table>\n            <div class=\"pagination\">\n              <Page @on-change=\"materialPageChange\" size=\"small\" :total=\"materialTotal\" ></Page>\n            </div>\n          </div>\n        </div>\n        <div slot=\"footer\">\n          <Button @click=\"showModal=false\">关闭</Button>\n          <Button type=\"primary\" @click=\"sureMaterial\">确认</Button>\n        </div>\n      </Modal>\n\n    </Card>\n</template>\n\n<script>\n  import util from '../../libs/util'\n    export default {\n        name: \"new-out\",\n      data(){\n          return {\n            sureAdd:false, //添加辅材，loading控制\n            loadingSave:false,\n            showModal:false,\n            outputForm:{\n              sn:'',\n              outputType:'',\n            },\n            outputFormRule:{\n              outputType:[{required:true,message:'请选择出库类型',trigger:'change'}]\n            },\n            searchForm:{\n              categoryId:'',\n              searchKey:'',\n              pageSize:5,\n              pageNo:1,\n            },\n            repairType:[],//报修分类列表\n            materialCheckedlists:[ ],\n            materialTotal:0, //辅材搜索，列表总条数\n            materialLists:[], //辅材列表\n            materialCheck:[], //弹窗已选辅材\n            materialCheckTemp:[], //弹窗已选辅材\n          }\n      },\n      methods:{\n        deleteMater(ind){\n          this.materialCheckedlists.splice(ind,1);\n        },\n        //弹窗显示状态变化\n        modalVisible(visible){\n          /*\n          *  materialLists:[], //辅材列表\n          *    materialCheckedlists  //界面已选辅材\n          * */\n          if(!visible){\n            this.materialCheckTemp=[];\n            this.materialLists=[];\n            this.materialCheck=this.materialCheckedlists;\n            this. searchForm={\n              categoryId:'',\n              searchKey:'',\n              pageSize:5,\n              pageNo:1,\n            };\n          }\n        },\n        //辅材分页切换\n        materialPageChange(val){\n          this.searchForm.pageSIze=val;\n          this.searchMaterial();\n        },\n        //确定弹窗\n        sureMaterial(){\n          let checkLists = this.materialCheckTemp;\n          this.showModal=false;\n          let checkTemp = checkLists.map(item=>{\n            item.num=null;\n            item.amount=null;\n\n\n            return item;\n          });\n          this.materialCheckedlists = this.materialCheckedlists.concat(checkTemp);\n\n        },\n        //搜索辅材\n        searchMaterial(){\n          let param =util.formatterParams(this.searchForm);\n          this.$http.post(`/repair/material/selectList?${param}`)\n            .then(res=>{\n              if(res.data.code===0){\n                let data = res.data.data;\n                let checkedLists = this.materialCheckTemp;\n                // 用于标记已选辅材\n                this.materialLists = data.list.map((item,index)=>{\n                  checkedLists.forEach(checkItem=>{\n                    if(item.id===checkItem.id){\n                      item.checked='1-'+index;\n                    }\n                  });\n                  if(!item.checked){\n                    item.checked='0-'+index;\n                  }\n                  return item;\n                });\n                // 禁用已选项\n                let hasChecked = this.materialCheck;\n                let lists = this.materialLists;\n                this.materialLists=this.compareChoosed(hasChecked,lists);\n\n                //设置页码\n                this.materialTotal = data.totalCount\n              }else{\n                console.log('辅材搜索失败：'+res.data.msg)\n              }\n            })\n        },\n        //数量输入改变\n        numChange(val,index){\n          this.materialCheckedlists=this.materialCheckedlists.map((item,ind)=>{\n            if(index===ind&&item.num>0){\n              item.amount=(item.price*item.num).toFixed(2)\n            }\n            return item;\n          });\n        },\n        //获取辅材分类\n        getRepairType(){\n          this.$http.get(`/repair/category/list`)\n            .then(res=>{\n              if(res.data.code===0){\n                this.repairType=res.data.data;\n              }else{\n                console.log('报修分类获取失败：'+res.data.msg);\n              }\n            })\n        },\n        //弹窗选择辅材交互\n        checkChange(val){\n          /**\n           * 辅材选择切换：val构成： boolean-index\n           */\n          let materialLists = this.materialLists;\n          val = val.split('-');\n          let checked = val[0];\n          let index = parseInt(val[1]);\n          if(checked==='1'){\n            this.materialCheckTemp.push(materialLists[index])\n          }else{\n            this.materialCheckTemp.map((item,ind)=>{\n              if(item.id===materialLists[index].id){\n                this.materialCheckTemp.splice(ind,1);\n              }\n            });\n          }\n\n        },\n        /*用于比对已选辅材*/\n        compareChoosed(hasCheck,lists){\n          lists=lists.map(item=>{\n            hasCheck.forEach(check=>{\n              if(item.id===check.id){\n                item.disabled=true;\n              }\n            });\n            if(!item.disabled){\n              item.disabled=false;\n            }\n            return item;\n          });\n          return lists;\n        },\n        sureOut(){\n          this.loadingSave=true;\n          let form = this.outputForm;\n          let detailList = this.materialCheckedlists;\n          let detailValid = true;\n          this.materialCheckedlists=detailList.map(item=>{\n            item.notValidType=[];\n            item.notValid=false;\n            if(!item.num){\n              detailValid=false;\n              item.notValid=true;\n              item.notValidType.push('num');\n            }\n            return item;\n          });\n          if(!detailValid){\n            this.loadingSave=false;\n            return;\n          }\n          this.$refs['outForm'].validate(valid=>{\n            if(valid){\n              form.detailList=detailList.map(item=>{\n                let data = {\n                  materialId:item.id,\n                  price:item.price,\n                  amount:item.amount,\n                  num:item.num\n                };\n                return data;\n              });\n              this.$http.post(`/repair/material/output/order/add`,{\n                ...form\n              }).then(res=>{\n                this.loadingSave=false;\n                if(res.data.code===0){\n                  this.$Message.success('保存成功');\n                  this.$router.push({name:'output'})\n                }else{\n                  this.$Message.error(res.data.msg);\n                }\n              })\n            }else{\n              this.loadingSave=false;\n            }\n          })\n        }\n      },\n      mounted(){\n          this.getRepairType();\n          this.searchMaterial();\n      }\n    }\n</script>\n\n\n\n\n\n// WEBPACK FOOTER //\n// src/pages/source/new-out.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Card',{staticStyle:{\"padding-bottom\":\"30px\"}},[_c('div',{staticClass:\"clearfix mb-15\"},[_c('div',{staticClass:\"pull-left\"},[_c('Button',{on:{\"click\":function($event){_vm.$router.back()}}},[_vm._v(\"返回上一页\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"pull-right\"},[_c('Button',{attrs:{\"loading\":_vm.loadingSave,\"type\":\"primary\"},on:{\"click\":_vm.sureOut}},[_vm._v(\"确定出库\")])],1)]),_vm._v(\" \"),_c('Form',{ref:\"outForm\",staticStyle:{\"margin-right\":\"200px\"},attrs:{\"model\":_vm.outputForm,\"rules\":_vm.outputFormRule,\"label-width\":100}},[_c('FormItem',{attrs:{\"label\":\"出库类型\",\"prop\":\"outputType\"}},[_c('Select',{staticClass:\"w300\",model:{value:(_vm.outputForm.outputType),callback:function ($$v) {_vm.$set(_vm.outputForm, \"outputType\", $$v)},expression:\"outputForm.outputType\"}},[_c('Option',{attrs:{\"value\":\"REFUND\"}},[_vm._v(\"退货\")])],1)],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"原始单号\"}},[_c('Input',{staticClass:\"w400\",model:{value:(_vm.outputForm.sn),callback:function ($$v) {_vm.$set(_vm.outputForm, \"sn\", $$v)},expression:\"outputForm.sn\"}})],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"辅材\"}},[_c('Button',{on:{\"click\":function($event){_vm.showModal=true}}},[_vm._v(\"添加辅材\")])],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"table-wrapper\"},[_c('table',{staticClass:\"native-table\"},[_c('thead',[_c('tr',[_c('th',[_vm._v(\"辅材名称\")]),_vm._v(\" \"),_c('th',[_vm._v(\"型号\")]),_vm._v(\" \"),_c('th',[_vm._v(\"单位\")]),_vm._v(\" \"),_c('th',[_vm._v(\"单价\")]),_vm._v(\" \"),_c('th',[_vm._v(\"数量  \"),_c('span',{staticClass:\"text-red\"},[_vm._v(\"*\")])]),_vm._v(\" \"),_c('th',[_vm._v(\"出库成本\")]),_vm._v(\" \"),_c('th',[_vm._v(\"操作\")])])]),_vm._v(\" \"),_c('tbody',_vm._l((_vm.materialCheckedlists),function(material,index){return _c('tr',{key:index},[_c('td',[_vm._v(_vm._s(material.name))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(material.spec))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(material.unit))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(material.price))]),_vm._v(\" \"),_c('td',{staticStyle:{\"width\":\"200px\"}},[_c('InputNumber',{staticStyle:{\"width\":\"80%\"},attrs:{\"step\":1,\"min\":1,\"placeholder\":\"请输入数量\"},on:{\"on-change\":function($event){_vm.numChange(material.num,index)}},model:{value:(material.num),callback:function ($$v) {_vm.$set(material, \"num\", $$v)},expression:\"material.num\"}}),_vm._v(\" \"),(material.notValid&&material.notValidType.indexOf('num')>-1)?_c('p',{staticClass:\"text-red\"},[_vm._v(\"请输入单价\")]):_vm._e()],1),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(material.amount))]),_vm._v(\" \"),_c('td',[_c('Button',{staticClass:\"text-red\",attrs:{\"type\":\"text\"},on:{\"click\":function($event){_vm.deleteMater(index)}}},[_vm._v(\"删除\")])],1)])}))])]),_vm._v(\" \"),_c('Modal',{attrs:{\"title\":\"选择辅材\",\"width\":\"650\"},on:{\"on-visible-change\":_vm.modalVisible},model:{value:(_vm.showModal),callback:function ($$v) {_vm.showModal=$$v},expression:\"showModal\"}},[_c('div',[_c('div',{staticClass:\"mb-15\"},[_c('Form',{ref:\"searchForm\",attrs:{\"model\":_vm.searchForm,\"inline\":\"\",\"label-width\":70}},[_c('FormItem',{attrs:{\"label\":\"辅材类别\"}},[_c('Select',{staticStyle:{\"width\":\"160px\"},model:{value:(_vm.searchForm.categoryId),callback:function ($$v) {_vm.$set(_vm.searchForm, \"categoryId\", $$v)},expression:\"searchForm.categoryId\"}},_vm._l((_vm.repairType),function(repair){return _c('Option',{key:repair.id,attrs:{\"value\":repair.id}},[_vm._v(_vm._s(repair.name))])}))],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"关键字\"}},[_c('Input',{attrs:{\"placeholder\":\"请输入辅材名称或型号\"},model:{value:(_vm.searchForm.searchKey),callback:function ($$v) {_vm.$set(_vm.searchForm, \"searchKey\", $$v)},expression:\"searchForm.searchKey\"}})],1),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.searchMaterial}},[_vm._v(\"搜索\")])],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"table-wrapper\"},[_c('table',{staticClass:\"native-table\"},[_c('thead',[_c('tr',[_c('th',[_vm._v(\"辅材名称\")]),_vm._v(\" \"),_c('th',[_vm._v(\"型号\")]),_vm._v(\" \"),_c('th',[_vm._v(\"单位\")]),_vm._v(\" \"),_c('th',[_vm._v(\"操作\")])])]),_vm._v(\" \"),_c('tbody',_vm._l((_vm.materialLists),function(material,index){return _c('tr',{key:material.id},[_c('td',[_vm._v(_vm._s(material.name))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(material.spec))]),_vm._v(\" \"),_c('td',[_vm._v(_vm._s(material.unit))]),_vm._v(\" \"),_c('td',[_c('Checkbox',{attrs:{\"disabled\":material.disabled,\"true-value\":1+'-'+index,\"false-value\":0+'-'+index},on:{\"on-change\":_vm.checkChange},model:{value:(material.checked),callback:function ($$v) {_vm.$set(material, \"checked\", $$v)},expression:\"material.checked\"}},[_vm._v(\"选择\")])],1)])}))]),_vm._v(\" \"),_c('div',{staticClass:\"pagination\"},[_c('Page',{attrs:{\"size\":\"small\",\"total\":_vm.materialTotal},on:{\"on-change\":_vm.materialPageChange}})],1)])]),_vm._v(\" \"),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('Button',{on:{\"click\":function($event){_vm.showModal=false}}},[_vm._v(\"关闭\")]),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.sureMaterial}},[_vm._v(\"确认\")])],1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-a08f71aa\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/source/new-out.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-a08f71aa\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./new-out.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./new-out.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./new-out.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-a08f71aa\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./new-out.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-a08f71aa\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/source/new-out.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}