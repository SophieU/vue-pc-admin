webpackJsonp([45],{"9Gor":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("Dd8w"),i=a.n(r),o=a("TVG1"),l={name:"staff-order-info",data:function(){return{filter:!1,id:"",columns:[{title:"工单号",key:"sn",align:"center"},{title:"报修类型",key:"repairCategoryName",align:"center"},{title:"创建时间",key:"createTime",align:"center"},{title:"工单状态",key:"orderState",align:"center"},{title:"操作",align:"center",render:function(t,e){return t("Button",{props:{type:"text"}},"查看订单")}}],lists:[],repairTypeLists:[],pageNo:1,pageSize:10,totalCount:0,orderCount:{},filterForm:{dateRange:[],orderStateList:[],repairCategoryId:"",startDate:"",endDate:""},filterDateRange:[]}},methods:{dateRangeChange:function(t){this.filterForm.startDate=t[0],this.filterForm.endDate=t[1]},getLists:function(t){var e=this,a={},r="pageNo="+this.pageNo+"&pageSize="+this.pageSize,o=this.id;t&&(a=t),this.$http.post("server/order/list?"+r,i()({id:o},a)).then(function(a){if(0===a.data.code){var r=a.data.data;e.pageSize=r.pageSize,e.totalCount=r.pageCount,e.lists=r.list,e.filter=!1,t&&t.startDate?e.filterDateRange=[t.startDate,t.endDate]:e.filterDateRange=[]}else console.log("员工工单列表："+a.data.msg)})},getOrderCount:function(){var t=this;this.$http.get("/server/order/count?id="+this.id).then(function(e){0===e.data.code&&(t.orderCount=e.data.data)})},clearFilter:function(t){this.$refs[t].resetFields(),this.getLists(),this.filter=!1},sureFilter:function(){var t=i()({},this.filterForm);delete t.dateRange;var e={};for(var a in t)(t[a].length>0||t[a]>0)&&(e[a]=t[a]);this.getLists(e)},pageChange:function(t){this.pageNo=t;var e=i()({},this.filterForm);delete e.dateRange;var a={};for(var r in e)(e[r].length>0||e[r]>0)&&(a[r]=e[r]);this.getLists(a)},pageSizeChange:function(t){this.pageSize=t;var e=i()({},this.filterForm);delete e.dateRange;var a={};for(var r in e)(e[r].length>0||e[r]>0)&&(a[r]=e[r]);this.getLists(a)},exportExcel:function(){var t=i()({},this.filterForm);delete t.dateRange;var e={};for(var a in t)(t[a].length>0||t[a]>0)&&(e[a]=t[a]);var r=this.id;this.$http.post("/server/order/list/export",i()({id:r},e),{responseType:"blob"}).then(function(t){var e=new Blob([t.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8"}),a=document.createElement("a"),r=window.URL.createObjectURL(e);a.href=r,a.download="工单列表.xlsx",document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(r)})}},mounted:function(){var t=this;this.id=this.$route.query.id,this.getLists(),this.getOrderCount(),o.a.getRepairType(function(e){t.repairTypeLists=e})}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",{staticClass:"mb-15"},[a("table",{staticClass:"native-table"},[a("thead",[a("tr",[a("th",[t._v("历史订单总数")]),t._v(" "),a("th",[t._v("本月订单总数")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v(t._s(t.orderCount.totalOrderNum))]),t._v(" "),a("td",[t._v(t._s(t.orderCount.currentMonthOrderNum))])])])])]),t._v(" "),a("Card",[a("p",{staticStyle:{"font-weight":"normal",color:"#555"},attrs:{slot:"title"},slot:"title"},[t.filterDateRange[0]&&t.filterDateRange[1]?a("span",[t._v(" 时间：2018/08/01-2018/08/31")]):t._e()]),t._v(" "),a("div",{staticStyle:{"margin-top":"-5px"},attrs:{slot:"extra"},slot:"extra"},[a("Button",{on:{click:function(e){t.filter=!0}}},[t._v("筛选")]),t._v(" "),a("Button",{attrs:{type:"primary"},on:{click:t.exportExcel}},[t._v("excel导出")])],1),t._v(" "),a("div",{staticClass:"table-wrapper"},[a("Table",{attrs:{columns:t.columns,data:t.lists}}),t._v(" "),a("div",{staticClass:"pagination"},[a("Page",{attrs:{total:t.totalCount,"show-elevator":"","show-sizer":""},on:{"on-change":t.pageChange,"on-page-size-change":t.pageSizeChange}})],1)],1)]),t._v(" "),a("Drawer",{attrs:{width:"450",title:"收益筛选","mask-closable":!1},on:{"on-close":function(e){t.clearFilter("filterForm")}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}},[a("div",{staticClass:"clearfix mb-15"},[a("div",{staticClass:"pull-left"},[a("Button",{on:{click:function(e){t.clearFilter("filterForm")}}},[t._v("清空筛选条件")])],1),t._v(" "),a("div",{staticClass:"pull-right"},[a("Button",{attrs:{type:"primary"},on:{click:t.sureFilter}},[t._v("确定筛选")])],1)]),t._v(" "),a("Form",{ref:"filterForm",attrs:{model:t.filterForm,"label-position":"top"}},[a("FormItem",{attrs:{label:"服务类型",prop:"repairCategoryId"}},[a("Select",{model:{value:t.filterForm.repairCategoryId,callback:function(e){t.$set(t.filterForm,"repairCategoryId",e)},expression:"filterForm.repairCategoryId"}},t._l(t.repairTypeLists,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}))],1),t._v(" "),a("FormItem",{attrs:{label:"工单时间",prop:"dateRange"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"daterange"},on:{"on-change":t.dateRangeChange},model:{value:t.filterForm.dateRange,callback:function(e){t.$set(t.filterForm,"dateRange",e)},expression:"filterForm.dateRange"}})],1),t._v(" "),a("FormItem",{attrs:{label:"工单状态",prop:"orderStateList"}},[a("CheckboxGroup",{model:{value:t.filterForm.orderStateList,callback:function(e){t.$set(t.filterForm,"orderStateList",e)},expression:"filterForm.orderStateList"}},[a("Checkbox",{attrs:{label:"ASSIGNED"}},[t._v("待分配")]),t._v(" "),a("Checkbox",{attrs:{label:"WAIT_DOOR"}},[t._v("待上门")]),t._v(" "),a("Checkbox",{attrs:{label:"WAITING_DOOR"}},[t._v("已上门")]),t._v(" "),a("Checkbox",{attrs:{label:"STAY_PAY"}},[t._v("待付款")]),t._v(" "),a("Checkbox",{attrs:{label:"WAIT_SERVICE"}},[t._v("待服务")]),t._v(" "),a("Checkbox",{attrs:{label:"FINISH"}},[t._v("已完成")]),t._v(" "),a("Checkbox",{attrs:{label:"AFTER_SALE"}},[t._v("售后中")]),t._v(" "),a("Checkbox",{attrs:{label:"CANCEL"}},[t._v("已取消")]),t._v(" "),a("Checkbox",{attrs:{label:"CLOSED"}},[t._v("已关闭")]),t._v(" "),a("Checkbox",{attrs:{label:"EXCEPTION"}},[t._v("异常")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var s=a("VU/8")(l,n,!1,function(t){a("Eygk")},"data-v-0769520f",null);e.default=s.exports},Eygk:function(t,e){}});
//# sourceMappingURL=45.b390dda3da77f861312c.js.map