webpackJsonp([36],{"8kS4":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("Dd8w"),n=i.n(a),r=i("TVG1"),o={name:"income-detail",data:function(){return{viewType:"month",filter:!1,repairColumns:[{title:"报修类型",key:"name",align:"center"},{title:"工单收入",key:"orderAmount",align:"center"},{title:"员工结算",key:"employeeCommission",align:"center"},{title:"平台佣金",key:"platformCommission",align:"center"},{title:"辅料成本",key:"materialEarning",align:"center"},{title:"辅料亏损",key:"materialCheckEarning",align:"center"},{title:"服务收益",key:"serviceEarning",align:"center"}],detailColumn:[{title:"报修类型",key:"repairCategoryName",align:"center"},{title:"服务网点",key:"departmentName",align:"center"},{title:"工单收入",key:"orderAmount",align:"center"},{title:"员工结算",key:"employeeCommission",align:"center"},{title:"平台佣金",key:"platformCommission",align:"center"},{title:"辅料成本",key:"materialEarning",align:"center"},{title:"辅料亏损",key:"materialCheckEarning",align:"center"},{title:"服务收益",key:"serviceEarning",align:"center"}],detailLists:[],earningCount:{},categoryEarningCountList:[],repairLists:[],stationLists:[],pageNo:1,pageSize:10,totalCount:0,filterForm:{repairCategoryId:"",departmentId:"",dateRange:[]}}},methods:{getTotal:function(t){var e=this,i={timeType:1};"month"===this.viewType?i.timeScope=1:"three"===this.viewType&&(i.timeScope=2),t&&(i=n()({},t),t.startDate&&t.endDate&&(i.timeType=2,delete i.timeScope)),i=r.a.formatterParams(i),this.$http.post("/earning/count?"+i).then(function(t){if(0===t.data.code){var i=t.data.data;e.earningCount=i.earningCount,e.categoryEarningCountList=i.categoryEarningCountList}else console.log("辅材核算统计失败："+t.data.msg)})},getDetailLists:function(t){var e=this,i="pageSize="+this.pageSize+"&pageNo="+this.pageNo,a={timeType:1};"month"===this.viewType?a.timeScope=1:"three"===this.viewType&&(a.timeScope=2),t&&(a=n()({},t),t.startDate&&t.endDate&&(a.timeType=2,this.viewType="",delete a.timeScope)),a=r.a.formatterParams(a),this.$http.post("/earning/list?"+i+"&"+a).then(function(i){if(0===i.data.code){var a=i.data.data;e.detailLists=a.list,e.pageSize=a.pageSize,e.totalCount=a.totalCount,e.filter=!1,t&&t.startDate&&(e.viewType="")}else console.log("辅材核算明细列表失败："+i.data.msg)})},pageChange:function(t){this.pageNo=t,this.getDetailLists()},pageSizeChange:function(t){this.pageSize=t,this.getDetailLists()},filterDateChange:function(t){this.filterForm.startDate=t[0],this.filterForm.endDate=t[1]},clearFilter:function(t){this.$refs[t].resetFields(),this.filter=!1,this.viewType="month",this.getDetailLists(),this.getTotal()},sureFilter:function(){var t=n()({},this.filterForm);delete t.dateRange,this.getDetailLists(t),this.getTotal(t)},exportExcel:function(){var t=n()({},this.filterForm),e={timeType:1};for(var i in"month"===this.viewType?e.timeScope=1:"three"===this.viewType&&(e.timeScope=2),t)(t[i].length>0||t[i]>0)&&(e[i]=t[i]),e.startDate&&e.endDate&&(e.timeType=2,delete e.timeScope,delete e.dateRange);var a=r.a.formatterParams(e);this.$http.post("/earning/export?"+a,null,{responseType:"blob"}).then(function(t){r.a.downloadExcel(t)})}},mounted:function(){var t=this;r.a.getRepairType(function(e){t.repairLists=e}),r.a.getStationLists(function(e){t.stationLists=e}),this.getTotal(),this.getDetailLists()},watch:{viewType:function(t){t&&(this.getDetailLists(),this.getTotal())}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Card",[i("div",{staticClass:"clearfix mb-15"},[i("div",{staticClass:"pull-left"},[i("Button",{attrs:{type:"month"===t.viewType?"primary":"default"},on:{click:function(e){t.viewType="month"}}},[t._v("本月")]),t._v(" "),i("Button",{attrs:{type:"three"===t.viewType?"primary":"default"},on:{click:function(e){t.viewType="three"}}},[t._v("前三月")]),t._v(" "),i("Button",{on:{click:function(e){t.filter=!0}}},[t._v("筛选")])],1),t._v(" "),i("div",{staticClass:"pull-right"},[i("Button",{attrs:{type:"primary"},on:{click:t.exportExcel}},[t._v("excel导出")])],1)]),t._v(" "),i("div",[i("div",{staticClass:"table-wrapper mb-15"},[i("table",{staticClass:"native-table"},[i("thead",[i("tr",[i("th",[t._v("项目名称")]),t._v(" "),i("th",[t._v("工单收入")]),t._v(" "),i("th",[t._v("员工结算")]),t._v(" "),i("th",[t._v("平台佣金")]),t._v(" "),i("th",[t._v("辅料成本")]),t._v(" "),i("th",[t._v("辅料亏损")]),t._v(" "),i("th",[t._v("服务收益")])])]),t._v(" "),i("tbody",[i("tr",[i("td",[t._v(t._s(t.earningCount.name))]),t._v(" "),i("td",[t._v(t._s(t.earningCount.orderAmount))]),t._v(" "),i("td",[t._v(t._s(t.earningCount.employeeCommission))]),t._v(" "),i("td",[t._v(t._s(t.earningCount.platformCommission))]),t._v(" "),i("td",[t._v(t._s(t.earningCount.materialEarning))]),t._v(" "),i("td",[t._v(t._s(t.earningCount.materialCheckEarning))]),t._v(" "),i("td",[t._v(t._s(t.earningCount.serviceEarning))])])])])]),t._v(" "),i("div",{staticClass:"table-wrapper mb-15"},[i("Table",{attrs:{columns:t.repairColumns,data:t.categoryEarningCountList}})],1),t._v(" "),i("div",{staticClass:"table-wrapper"},[i("h4",{staticClass:"mb-15"},[t._v("明细")]),t._v(" "),i("Table",{attrs:{columns:t.detailColumn,data:t.detailLists}}),t._v(" "),i("div",{staticClass:"pagination"},[i("Page",{attrs:{total:t.totalCount,"show-sizer":"","show-elevator":""},on:{"on-change":t.pageChange,"on-page-size-change":t.pageSizeChange}})],1)],1)]),t._v(" "),i("Drawer",{attrs:{title:"工单筛选",width:"450"},on:{"on-close":function(e){t.clearFilter("filterForm")}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}},[i("div",{staticClass:"clearfix mb-15"},[i("div",{staticClass:"pull-left"},[i("Button",{on:{click:function(e){t.clearFilter("filterForm")}}},[t._v("清空筛选条件")])],1),t._v(" "),i("div",{staticClass:"pull-right"},[i("Button",{attrs:{type:"primary"},on:{click:t.sureFilter}},[t._v("确定")])],1)]),t._v(" "),i("Form",{ref:"filterForm",attrs:{model:t.filterForm,"label-position":"top"}},[i("FormItem",{attrs:{label:"报修类型",prop:"repairCategoryId"}},[i("Select",{model:{value:t.filterForm.repairCategoryId,callback:function(e){t.$set(t.filterForm,"repairCategoryId",e)},expression:"filterForm.repairCategoryId"}},t._l(t.repairLists,function(e){return i("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}))],1),t._v(" "),i("FormItem",{attrs:{label:"服务网点",prop:"departmentId"}},[i("Select",{model:{value:t.filterForm.departmentId,callback:function(e){t.$set(t.filterForm,"departmentId",e)},expression:"filterForm.departmentId"}},t._l(t.stationLists,function(e){return i("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}))],1),t._v(" "),i("FormItem",{attrs:{label:"时间",prop:"dateRange"}},[i("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"daterange"},on:{"on-change":t.filterDateChange},model:{value:t.filterForm.dateRange,callback:function(e){t.$set(t.filterForm,"dateRange",e)},expression:"filterForm.dateRange"}})],1)],1)],1)],1)},staticRenderFns:[]};var s=i("VU/8")(o,l,!1,function(t){i("BUrV")},"data-v-34da48b1",null);e.default=s.exports},BUrV:function(t,e){}});
//# sourceMappingURL=36.1d366389f1fa695504d7.js.map