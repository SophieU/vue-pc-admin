webpackJsonp([30],{"54F/":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o={name:"account-admin",data:function(){var t=this;return{editPwdInput:!1,view:!1,pageNo:1,hasNextPage:!0,totalCount:0,pageSize:10,activeModal:!1,modalTitle:"新建账号",column:[{title:"账号",key:"loginName",align:"center"},{title:"手机",key:"mobile",align:"center"},{title:"角色",key:"roleName",align:"center"},{title:"状态",key:"state",align:"center"},{title:"操作",align:"center",render:function(e,a){var o=t;return e("div",[e("Button",{props:{type:"text",size:"small"},on:{click:function(){var t=a.row.id;o.activeModal=!0,o.editPwdInput=!1,o.view=!0,o.modalTitle="查看账号",o.getAccountInfo(t)}}},"查看"),e("Button",{props:{type:"text",size:"small"},on:{click:function(){var t=a.row.id;o.activeModal=!0,o.editPwdInput=!1,o.view=!1,o.modalTitle="编辑账号",o.getAccountInfo(t)}}},"编辑")])}}],accountList:[],roleLists:[],accountForm:{loginName:"",password:"",mobile:"",type:"",isOpen:!0,roleId:"",callCenterId:"",id:""},accountRule:{loginName:[{required:!0,message:"请输入账号名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],mobile:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:function(t,e,a){e.length<=0?a(new Error("请输入手机号")):/^1[3456789]\d{9}/.test(e)?a(new Error("请输入正确的手机号")):a()},trigger:"blur"}],roleId:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},methods:{openModalNew:function(){this.activeModal=!0,this.view=!1,this.editPwdInput=!0,this.modalTitle="新建账号",this.accountForm={loginName:"",password:"",mobile:"",isOpen:!0,roleId:"",id:"",callCenterId:"",type:""}},getLists:function(){var t=this;this.$http.get("/user/list").then(function(e){if(0===e.data.code){var a=e.data.data;t.totalCount=a.totalCount,t.hasNextPage=a.hasNextPage,t.hasNextPage&&(t.pageNo=a.nextPage),t.accountList=a.list}else t.$Message.error(e.data.msg)})},getAccountInfo:function(t){var e=this;this.$http.get("/user/info?id="+t).then(function(t){0===t.data.code?(e.accountForm=t.data.data,e.accountForm.isOpen="Y"===e.accountForm.isOpen):e.$Message.error(t.data.msg)})},getRoleLists:function(){var t=this;this.$http.get("/role/list").then(function(e){if(0===e.data.code){var a=e.data.data;t.roleLists=a}})},saveAccount:function(){var t=this,e=this.accountForm,a="";a=e.id.length>0?"/user/edit":"/user/add",this.$refs.accountForm.validate(function(o){o&&t.$http.post(a,{loginName:e.loginName,password:t.editPwdInput?e.password:"",mobile:e.mobile,isOpen:e.isOpen?"Y":"N",roleId:e.roleId,id:e.id,callCenterId:e.callCenterId}).then(function(e){0===e.data.code?(t.$Message.success("保存成功"),t.getLists()):t.$Message.error(e.data.msg),t.editPwdInput=!1,t.activeModal=!1})})},editPwd:function(){this.accountForm.password="",this.editPwdInput=!0},modalChange:function(t){t||this.$refs.accountForm.resetFields()}},mounted:function(){this.getLists(),this.getRoleLists()}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",[a("div",{staticClass:"clearfix mb-15"},[a("div",{staticClass:"pull-left"},[a("Button",{attrs:{type:"primary",icon:"md-add-circle"},on:{click:t.openModalNew}},[t._v("新建")])],1)]),t._v(" "),a("div",{staticClass:"table-wrapper"},[a("Table",{attrs:{data:t.accountList,columns:t.column}}),t._v(" "),a("div",{staticClass:"pagination"},[a("Page",{attrs:{total:t.totalCount,"page-size":t.pageSize,"show-sizer":"","show-elevator":""}})],1)],1)]),t._v(" "),a("Modal",{attrs:{title:t.modalTitle},on:{"on-visible-change":t.modalChange},model:{value:t.activeModal,callback:function(e){t.activeModal=e},expression:"activeModal"}},[a("div",{staticClass:"modal_wrap_form"},[a("Form",{ref:"accountForm",attrs:{model:t.accountForm,rules:t.accountRule,"label-position":"top"}},[a("FormItem",{attrs:{label:"登陆账号",prop:"loginName"}},[a("Input",{attrs:{disabled:t.view},model:{value:t.accountForm.loginName,callback:function(e){t.$set(t.accountForm,"loginName",e)},expression:"accountForm.loginName"}})],1),t._v(" "),a("FormItem",{attrs:{label:"登陆密码",prop:"password"}},[a("Input",{attrs:{disabled:t.view||!t.editPwdInput,type:"password"},model:{value:t.accountForm.password,callback:function(e){t.$set(t.accountForm,"password",e)},expression:"accountForm.password"}},[a("Button",{directives:[{name:"show",rawName:"v-show",value:"新建账号"!==t.modalTitle,expression:"modalTitle!=='新建账号'"}],attrs:{slot:"append",disabled:t.view},on:{click:t.editPwd},slot:"append"},[t._v("修改密码")])],1)],1),t._v(" "),a("FormItem",{attrs:{label:"账户角色",prop:"roleId"}},[a("Select",{attrs:{disabled:t.view},model:{value:t.accountForm.roleId,callback:function(e){t.$set(t.accountForm,"roleId",e)},expression:"accountForm.roleId"}},t._l(t.roleLists,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}))],1),t._v(" "),a("FormItem",{attrs:{label:"手机号",prop:"mobile"}},[a("Input",{attrs:{disabled:t.view},model:{value:t.accountForm.mobile,callback:function(e){t.$set(t.accountForm,"mobile",e)},expression:"accountForm.mobile"}})],1),t._v(" "),a("FormItem",[a("Row",[a("Col",{attrs:{span:"4"}},[t._v("账号状态")]),t._v(" "),a("Col",{attrs:{span:"12"}},[a("i-switch",{attrs:{disabled:t.view,size:"large"},model:{value:t.accountForm.isOpen,callback:function(e){t.$set(t.accountForm,"isOpen",e)},expression:"accountForm.isOpen"}},[a("span",{attrs:{slot:"open"},slot:"open"},[t._v("开启")]),t._v(" "),a("span",{attrs:{slot:"close"},slot:"close"},[t._v("关闭")])])],1)],1)],1)],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:function(e){t.activeModal=!1}}},[t._v("取消")]),t._v(" "),t.view?a("Button",{attrs:{type:"primary"},on:{click:function(e){t.view=!1}}},[t._v("编辑")]):t._e(),t._v(" "),t.view?t._e():a("Button",{attrs:{type:"primary"},on:{click:t.saveAccount}},[t._v("确定")])],1)])],1)},staticRenderFns:[]};var n=a("VU/8")(o,i,!1,function(t){a("cD58")},"data-v-5e4dc27d",null);e.default=n.exports},cD58:function(t,e){}});
//# sourceMappingURL=30.966882f5c7350768aa42.js.map