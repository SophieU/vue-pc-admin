{"version":3,"sources":["webpack:///src/pages/system/role-setting.vue","webpack:///./src/pages/system/role-setting.vue?f83c","webpack:///./src/pages/system/role-setting.vue"],"names":["role_setting","name","data","loadingSend","type","id","viewInfo","roleInfo","description","resourceList","callCenterId","authLists","authListsCheck","roleInfoRule","required","message","trigger","methods","checkNodes","arr","this","map","item","goback","$router","back","getRoleInfo","_this2","$http","get","then","res","code","getAuth","$Message","error","msg","saveThis","_this3","url","params","$refs","validate","valid","post","success","push","_this4","checkedLists","transformRes","_this","length","iteratorTree","title","expand","disabled","forEach","check","checked","console","log","obj","cb","_this5","result","Array","children","mounted","$route","query","watch","val","system_role_setting","render","_vm","_h","$createElement","_c","_self","staticStyle","padding-bottom","staticClass","attrs","on","click","$event","_v","_e","loading","ref","model","label-position","rules","gutter","span","label","prop","value","callback","$$v","$set","expression","rows","show-checkbox","multiple","on-check-change","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/42.0d2420b17683a195a0b1.js","sourcesContent":["<template>\n  <div>\n    <Card style=\"padding-bottom: 30px;\">\n      <div class=\"clearfix mb-15\">\n        <div class=\"pull-left\">\n          <Button type=\"primary\" @click=\"goback()\">返回上一页</Button>\n        </div>\n        <div class=\"pull-right\">\n          <Button @click=\"goback\" v-if=\"!viewInfo\">取消</Button>\n          <Button type=\"primary\" v-if=\"viewInfo\" @click=\"viewInfo=false\">编辑</Button>\n          <Button :loading=\"loadingSend\" v-if=\"!viewInfo\" type=\"primary\" @click=\"saveThis\">保存</Button>\n        </div>\n      </div>\n      <div class=\"role-panel\">\n        <Form ref=\"roleInfo\" :model=\"roleInfo\" label-position=\"top\" :rules=\"roleInfoRule\">\n          <Row :gutter=\"40\">\n            <Col span=\"12\">\n              <h4>基础信息</h4>\n                <FormItem label=\"角色名称\" prop=\"name\">\n                  <Input :disabled=\"viewInfo\" v-model=\"roleInfo.name\"/>\n                </FormItem>\n                <FormItem label=\"角色描述\" prop=\"description\">\n                  <Input :disabled=\"viewInfo\" v-model=\"roleInfo.description\" type=\"textarea\" :rows=\"10\"/>\n                </FormItem>\n            </Col>\n            <Col span=\"12\">\n              <h4>功能权限</h4>\n              <Tree ref=\"authTree\" :data=\"authLists\" show-checkbox multiple @on-check-change=\"checkNodes\"></Tree>\n            </Col>\n          </Row>\n        </Form>\n\n\n      </div>\n    </Card>\n  </div>\n</template>\n\n<script>\n    export default {\n        name: \"role-control\",\n      data(){\n        return {\n          loadingSend:false,\n          type:1, //页面操作类型—— 1:新建，0：编辑，2：查看\n          id:'',\n          viewInfo:false, //查看/编辑 状态\n          roleInfo:{\n            name:'',\n            description:'',\n            resourceList:'',\n            id:'',\n            callCenterId:'',\n          },\n          authLists:[],\n          authListsCheck:[],\n          roleInfoRule:{\n            name:[{required:true,message:'请输入角色名称',trigger:'blur'}],\n            description:[{required:true,message:'请输入角色描述',trigger:'blur'}],\n          }\n        }\n      },\n      methods:{\n          checkNodes(arr){\n            this.authListsCheck=arr.map(item=>{\n              return item.id;\n            })\n          },\n\n        goback(){\n          this.$router.back();\n        },\n        getRoleInfo(id){\n          this.$http.get(`/role/info?id=${id}`)\n            .then(res=>{\n              if(res.data.code===0){\n                this.roleInfo=res.data.data;\n                this.authListsCheck=res.data.data.resourceList;\n                this.getAuth();\n              }else{\n                this.$Message.error(res.data.msg)\n              }\n            })\n        },\n        saveThis(){\n            this.loadingSend=true;\n          let type = this.type;\n          let url='';\n          let params=this.roleInfo;\n          if(type===1){\n            url='/role/add'\n          }else{\n            url='/role/edit'\n          }\n          this.$refs['roleInfo'].validate(valid=>{\n            if(valid){\n              this.$http.post(url,{\n                name:params.name,\n                description:params.description,\n                resourceList:this.authListsCheck,\n                id:params.id\n              }).then(res=>{\n                if(res.data.code===0){\n                  this.$Message.success('保存成功');\n                  this.$router.push({name:'role'});\n                }else{\n                  this.$Message.error(res.data.msg);\n                }\n                this.loadingSend=false;\n              })\n            }else{\n              this.loadingSend=false;\n            }\n          })\n\n\n        },\n        //获取所有资源列表\n        getAuth(){\n          this.$http.get(`/resource/list`)\n            .then(res=>{\n              if(res.data.code===0){\n                let data = res.data.data;\n                let checkedLists = this.authListsCheck;\n                let transformRes = {};\n                let _this = this;\n               if(checkedLists.length>0){\n                 transformRes = this.iteratorTree(data,function(item){\n                   item.title=item.name;\n                   item.expand=true;\n                     item.disabled=_this.viewInfo;\n                   checkedLists.forEach(check=>{\n                     if(item.id===check){\n                       item.checked=true;\n                     }\n                   })\n                 })\n               }else{\n                 transformRes = this.iteratorTree(data,function(item){\n                   item.title=item.name;\n                   item.expand=true;\n                   item.disabled=_this.viewInfo;\n                   // item.selected=true;\n                 });\n               }\n\n                  this.authLists=transformRes;\n              }else{\n                console.log(res.data.msg);\n              }\n            })\n        },\n        //深度遍历\n        iteratorTree(obj,cb){\n          let result = [];\n          let _this = this;\n            if(obj instanceof Array){\n             result= obj.map(item=>{\n                typeof cb==='function'&&cb(item);\n                item.disabled=_this.viewInfo;\n                if(item.children&&item.children.length>0){\n                  this.iteratorTree(item.children,cb)\n                }\n                return item;\n              })\n            }\n          return result;\n\n        }\n      },\n      mounted(){\n          /*\n          type:角色类型  1:新建，0：编辑，2：查看\n          * */\n          this.type = this.$route.query.type;\n          this.id = this.$route.query.id;\n          if(this.type*1===0){\n            this.getRoleInfo(this.id);\n          }else if(this.type*1===2){\n            this.viewInfo=true;\n            this.getRoleInfo(this.id);\n          }else{\n            this.getAuth();\n          }\n\n          // this.$store.app.\n      },\n      watch:{\n        viewInfo(val){\n          this.getAuth();\n        },\n      }\n    }\n</script>\n\n<style scoped lang=\"scss\">\n  h4{\n    margin-bottom: 20px;\n    margin-top: 20px;\n  }\n  .role-panel{\n    position: relative;\n    .footer-right{\n      position: absolute;\n      bottom: 15px;\n      right: 50%;\n      transform: translateX(335%);\n    }\n    .auth-lists{\n      dt{\n        color: #000;\n        font-size: 16px;\n      }\n      dd{\n        padding-left: 20px;\n        font-size: 15px;\n      }\n      li{\n        display: inline-block;\n      }\n      /*margin-bottom: 50px;*/\n    }\n    .third-auth{\n      .auth-lists{\n        padding-left: 20px;\n      }\n    }\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/pages/system/role-setting.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('Card',{staticStyle:{\"padding-bottom\":\"30px\"}},[_c('div',{staticClass:\"clearfix mb-15\"},[_c('div',{staticClass:\"pull-left\"},[_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.goback()}}},[_vm._v(\"返回上一页\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"pull-right\"},[(!_vm.viewInfo)?_c('Button',{on:{\"click\":_vm.goback}},[_vm._v(\"取消\")]):_vm._e(),_vm._v(\" \"),(_vm.viewInfo)?_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.viewInfo=false}}},[_vm._v(\"编辑\")]):_vm._e(),_vm._v(\" \"),(!_vm.viewInfo)?_c('Button',{attrs:{\"loading\":_vm.loadingSend,\"type\":\"primary\"},on:{\"click\":_vm.saveThis}},[_vm._v(\"保存\")]):_vm._e()],1)]),_vm._v(\" \"),_c('div',{staticClass:\"role-panel\"},[_c('Form',{ref:\"roleInfo\",attrs:{\"model\":_vm.roleInfo,\"label-position\":\"top\",\"rules\":_vm.roleInfoRule}},[_c('Row',{attrs:{\"gutter\":40}},[_c('Col',{attrs:{\"span\":\"12\"}},[_c('h4',[_vm._v(\"基础信息\")]),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"角色名称\",\"prop\":\"name\"}},[_c('Input',{attrs:{\"disabled\":_vm.viewInfo},model:{value:(_vm.roleInfo.name),callback:function ($$v) {_vm.$set(_vm.roleInfo, \"name\", $$v)},expression:\"roleInfo.name\"}})],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"角色描述\",\"prop\":\"description\"}},[_c('Input',{attrs:{\"disabled\":_vm.viewInfo,\"type\":\"textarea\",\"rows\":10},model:{value:(_vm.roleInfo.description),callback:function ($$v) {_vm.$set(_vm.roleInfo, \"description\", $$v)},expression:\"roleInfo.description\"}})],1)],1),_vm._v(\" \"),_c('Col',{attrs:{\"span\":\"12\"}},[_c('h4',[_vm._v(\"功能权限\")]),_vm._v(\" \"),_c('Tree',{ref:\"authTree\",attrs:{\"data\":_vm.authLists,\"show-checkbox\":\"\",\"multiple\":\"\"},on:{\"on-check-change\":_vm.checkNodes}})],1)],1)],1)],1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1b98487c\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/system/role-setting.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1b98487c\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./role-setting.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./role-setting.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./role-setting.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1b98487c\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./role-setting.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-1b98487c\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/system/role-setting.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}