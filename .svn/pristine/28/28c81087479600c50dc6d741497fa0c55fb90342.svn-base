webpackJsonp([28],{"4sJp":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("Gu7T"),s=i.n(a),n={name:"role-control",data:function(){return{type:1,id:"",viewInfo:!1,roleInfo:{name:"",description:"",resourceList:"",id:"",callCenterId:""},authLists:[],authListsCheck:[]}},methods:{iteratorCheck:function(t){var e=this,i=[];return t.children&&t.children.length>0&&t.children.forEach(function(t){i.push(t.id);var a=e.iteratorCheck(t);i.push.apply(i,s()(a))}),i},checkOne:function(t,e){var i=t.target.checked,a=this.iteratorCheck(e);if(a.push(e.id),void 0!==i)if(i){var n;(n=this.authListsCheck).push.apply(n,s()(a))}else{var o=this.authListsCheck.filter(function(t){var e=!1;if(a.forEach(function(i){t===i&&(e=!0)}),!e)return t});this.authListsCheck=o}},goback:function(){this.$router.back()},getRoleInfo:function(t){var e=this;this.$http.get("/role/info?id="+t).then(function(t){0===t.data.code?(e.roleInfo=t.data.data,e.authListsCheck=t.data.data.resourceList,console.log(e.roleInfo)):e.$Message.error(t.data.msg)})},saveThis:function(){var t=this,e=this.type,i="",a=this.roleInfo;i=1===e?"/role/add":"/role/edit",this.$http.post(i,{name:a.name,description:a.description,resourceList:this.authListsCheck,id:a.id}).then(function(e){0===e.data.code?(t.$Message.success("保存成功"),t.$router.push({name:"role"})):t.$Message.error(e.data.msg)})},getAuth:function(){var t=this;this.$http.get("/resource/list").then(function(e){0===e.data.code?t.authLists=e.data.data:console.log(e.data.msg)})}},mounted:function(){this.type=this.$route.params.type,this.id=this.$route.params.id,0===this.type?this.getRoleInfo(this.id):2===this.type&&(this.viewInfo=!0,this.getRoleInfo(this.id)),this.getAuth()}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("Card",{staticStyle:{"padding-bottom":"30px"}},[i("div",{staticClass:"clearfix mb-15"},[i("div",{staticClass:"pull-left"},[i("Button",{attrs:{type:"primary"},on:{click:function(e){t.goback()}}},[t._v("返回上一页")])],1),t._v(" "),i("div",{staticClass:"pull-right"},[t.viewInfo?t._e():i("Button",{on:{click:t.goback}},[t._v("取消")]),t._v(" "),t.viewInfo?i("Button",{attrs:{type:"primary"},on:{click:function(e){t.viewInfo=!1}}},[t._v("编辑")]):t._e(),t._v(" "),t.viewInfo?t._e():i("Button",{attrs:{type:"primary"},on:{click:t.saveThis}},[t._v("保存")])],1)]),t._v(" "),i("div",{staticClass:"role-panel"},[i("Form",{attrs:{model:t.roleInfo,"label-position":"top"}},[i("Row",{attrs:{gutter:40}},[i("Col",{attrs:{span:"12"}},[i("h4",[t._v("基础信息")]),t._v(" "),i("FormItem",{attrs:{label:"角色名称"}},[i("Input",{attrs:{disabled:t.viewInfo},model:{value:t.roleInfo.name,callback:function(e){t.$set(t.roleInfo,"name",e)},expression:"roleInfo.name"}})],1),t._v(" "),i("FormItem",{attrs:{label:"角色描述"}},[i("Input",{attrs:{disabled:t.viewInfo,type:"textarea",rows:10},model:{value:t.roleInfo.description,callback:function(e){t.$set(t.roleInfo,"description",e)},expression:"roleInfo.description"}})],1)],1),t._v(" "),i("Col",{attrs:{span:"12"}},[i("h4",[t._v("功能权限")]),t._v(" "),i("dl",{staticClass:"auth-lists"},[i("CheckboxGroup",{model:{value:t.authListsCheck,callback:function(e){t.authListsCheck=e},expression:"authListsCheck"}},[t._l(t.authLists,function(e,a){return[i("dt",[i("Checkbox",{attrs:{disabled:t.viewInfo,label:e.id},nativeOn:{click:function(i){i.preventDefault(),t.checkOne(i,e)}}},[t._v(t._s(e.name))])],1),t._v(" "),e.children.length>0?i("dd",[t._l(e.children,function(e){return e.children.length<=0?[i("Checkbox",{attrs:{label:e.id,disabled:t.viewInfo},nativeOn:{click:function(i){i.preventDefault(),t.checkOne(i,e)}}},[t._v(t._s(e.name))])]:[i("div",{staticClass:"third-auth"},[i("div",{staticClass:"third-auth-title"},[i("Checkbox",{attrs:{label:e.id,disabled:t.viewInfo},nativeOn:{click:function(i){i.preventDefault(),t.checkOne(i,e)}}},[t._v(t._s(e.name))])],1),t._v(" "),i("ul",{staticClass:"auth-lists"},t._l(e.children,function(e,a){return i("li",{key:a},[i("Checkbox",{attrs:{label:e.id,disabled:t.viewInfo}},[t._v(t._s(e.name))])],1)}))])]})],2):t._e()]})],2)],1)])],1)],1)],1)])],1)},staticRenderFns:[]};var r=i("VU/8")(n,o,!1,function(t){i("GvVa")},"data-v-6094cf07",null);e.default=r.exports},GvVa:function(t,e){}});
//# sourceMappingURL=28.16712073ec68780f73c0.js.map